<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/zh_cn/webgl-scene-graph.md. Do not edited directly -->
<!--
Copyright 2021, GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="åœºæ™¯å›¾æ˜¯çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ã€‚">
<meta name="keywords" content="webgl webgl2 graphics">
<meta name="thumbnail" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-scene-graph_zh-cn.jpg">

<meta property="og:title" content="WebGL2 - åœºæ™¯å›¾">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-scene-graph_zh-cn.jpg">
<meta property="og:description" content="åœºæ™¯å›¾æ˜¯çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ã€‚">
<meta property="og:url" content="https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webgl2fundamentals.org">
<meta name="twitter:title" content="WebGL2 - åœºæ™¯å›¾">
<meta name="twitter:url" content="https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html">
<meta name="twitter:description" content="åœºæ™¯å›¾æ˜¯çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ã€‚">
<meta name="twitter:image:src" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-scene-graph_zh-cn.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webgl2fundamentals.org/#website",
      "url":"https://webgl2fundamentals.org/",
      "name":"Webgl2Fundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html#primaryimage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-scene-graph_zh-cn.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html#webpage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html",
      "inLanguage":"zh-cn",
      "name":"WebGL2 - åœºæ™¯å›¾",
      "keywords":"webgl webgl2 graphics programming",
      "isPartOf":{
        "@id":"https://webgl2fundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL2 - åœºæ™¯å›¾</title>
<link href="/webgl/lessons/resources/webgl2fundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-scene-graph.html">
  <link rel="alternate" hreflang="de" href="https://webglfundamentals.org/webgl/lessons/de/webgl-scene-graph.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-scene-graph.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-scene-graph.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-scene-graph.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-scene-graph.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-scene-graph.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-scene-graph.html" >English</a>
    <option value="/webgl/lessons/de/webgl-scene-graph.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl-scene-graph.html" >æ—¥æœ¬èª</a>
    <option value="/webgl/lessons/ko/webgl-scene-graph.html" >í•œêµ­ì–´</a>
    <option value="/webgl/lessons/pt-br/webgl-scene-graph.html" >PortuguÃªs Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl-scene-graph.html" >Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
    <option value="/webgl/lessons/zh_cn/webgl-scene-graph.html" selected>ç®€ä½“ä¸­æ–‡</a>
</select>


    <a href="#toc">ç›®å½•</a>
    <input type="search" placeholder="?" id="search">
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/zh_cn/">WebGL2Fundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL2 - åœºæ™¯å›¾</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>æ­¤æ–‡ä¸Šæ¥<a href="webgl-fundamentals.html">WebGL ç³»ç±»æ–‡ç« </a>ï¼Œ
ä¸Šä¸€ç¯‡æ˜¯<a href="webgl-drawing-multiple-things.html">ç»˜åˆ¶å¤šä¸ªç‰©ä½“</a>ï¼Œ
å¦‚æœæ²¡è¯»è¯·ä»é‚£é‡Œå¼€å§‹ã€‚</p>
<p>æˆ‘è§‰å¾—ä¸€äº› CS æˆ–å›¾å½¢å­¦å¤§å¸ˆä¼šæ‰“æˆ‘è„¸ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯å¾—è¯´ã€‚
åœºæ™¯å›¾é€šå¸¸æ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªçŸ©é˜µï¼Œ
è¿™å¯èƒ½å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„ä¹‰çš„å®šä¹‰ï¼Œä¹Ÿè®¸çœ‹å‡ ä¸ªä¾‹å­ä¼šæ›´æ¸…æ¥šã€‚</p>
<p>å¤§å¤šæ•°ä¸‰ç»´å¼•æ“ä½¿ç”¨åœºæ™¯å›¾ï¼Œå°†éœ€è¦æ˜¾ç¤ºçš„ä¸œè¥¿æ”¾åœ¨åœºæ™¯å›¾ä¸­ï¼Œ
å¼•æ“ä¼šéå†åœºæ™¯å›¾æ‰¾å‡ºéœ€è¦ç»˜åˆ¶çš„ä¸œè¥¿ã€‚åœºæ™¯å›¾å…·æœ‰å±‚çº§ç»“æ„ï¼Œ
å¦‚æœä½ æƒ³æ¨¡æ‹Ÿå®‡å®™è¿åŠ¨ï¼Œå¯èƒ½éœ€è¦è¿™æ ·ä¸€ä¸ªå›¾ã€‚</p>
<p><div class="webgl_diagram_container">
  <iframe class="webgl_example " style="width: 400px; height: 500px;" src="/webgl/lessons/resources/planet-diagram.html"></iframe>
</div>

</p>
<p>åœºæ™¯å›¾çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„é¦–è¦ä½œç”¨å°±æ˜¯ä¸ºçŸ©é˜µæä¾›äº†çˆ¶å­å…³ç³»ï¼Œå°±åƒ
<a href="webgl-2d-matrices.html">æˆ‘ä»¬è®²è¿‡çš„äºŒç»´çŸ©é˜µè¿ç®—</a>ä¸€æ ·ã€‚
ä¾‹å¦‚åœ¨ä¸€ä¸ªæ¨¡æ‹Ÿå®‡å®™çš„ä¾‹å­ä¸­ï¼ˆå¹¶ä¸æ˜¯çœŸå®çš„ï¼‰ï¼Œæ˜Ÿæ˜Ÿï¼ˆå­©å­ï¼‰åœ¨å®ƒä»¬æ‰€åœ¨çš„æ˜Ÿç³»ï¼ˆçˆ¶æ¯ï¼‰è¿ç”¨ï¼Œ
åŒæ ·çš„æœˆäº®ï¼ˆå­©å­ï¼‰ç»•ç€åœ°çƒï¼ˆçˆ¶æ¯ï¼‰è¿åŠ¨ï¼Œå¦‚æœåœ°çƒç§»åŠ¨ï¼Œæœˆäº®ä¹Ÿä¼šè·Ÿç€ç§»åŠ¨ã€‚
æ‹–åŠ¨ä¸Šå›¾ä¸­çš„åå­—ç„¶åè§‚å¯Ÿä»–ä»¬çš„å…³ç³»ã€‚</p>
<p>å¦‚æœä½ å›æƒ³<a href="webgl-2d-matrices.html">äºŒç»´çŸ©é˜µè¿ç®—</a>å¯èƒ½ä¼šæƒ³èµ·ï¼Œ
å¤šä¸ªçŸ©é˜µç›¸ä¹˜åå®ç°ç‰©ä½“çš„å¹³ç§»ï¼Œæ—‹è½¬å’Œç¼©æ”¾ã€‚åœºæ™¯å›¾æä¾›äº†ä¸€ä¸ªç»“æ„ï¼Œ
ä¸ºçŸ©é˜µä½œç”¨åœ¨å“ªä¸ªç‰©ä½“ä¸Šæä¾›äº†å¸®åŠ©ã€‚</p>
<p>ç†è®ºä¸Šåœºæ™¯å›¾ä¸­çš„æ¯ä¸ª <code class="notranslate" translate="no">Node</code> éƒ½ä»£è¡¨ä¸€ä¸ª<strong>é€»è¾‘ç©ºé—´</strong>ã€‚ä¸ºé‚£ä¸ª<strong>é€»è¾‘ç©ºé—´</strong>
æä¾›åˆé€‚çš„çŸ©é˜µä¸å¿…è€ƒè™‘åœ¨å®ƒä¹‹ä¸Šçš„ç‰©ä½“ã€‚å¦ä¸€ç§è¡¨è¾¾çš„æ–¹å¼æ˜¯æœˆäº®åªå…³å¿ƒç»•åœ°çƒè½¬åŠ¨çš„è½¨é“ï¼Œ
å®ƒä¸éœ€è¦è€ƒè™‘ç»•å¤ªé˜³è½¬åŠ¨çš„è½¨é“ï¼Œå¦‚æœæ²¡æœ‰åœºæ™¯å›¾ç»“æ„å°±éœ€è¦åšå¾ˆå¤šå¤æ‚çš„æ•°å­¦è¿ç®—å…¶è®¡ç®—æœˆäº®ç›¸å¯¹äºå¤ªé˜³çš„è½¨é“ï¼Œ
å› ä¸ºå®ƒç›¸å¯¹äºå¤ªé˜³çš„è½¨é“æ˜¯ç±»ä¼¼äºè¿™æ ·çš„</p>
<p><div class="webgl_diagram_container">
  <iframe class="webgl_example " style="width: 400px; height: 300px;" src="/webgl/lessons/resources/moon-orbit.html"></iframe>
</div>

</p>
<p>æœ‰äº†åœºæ™¯å›¾å°±åªéœ€è¦è®©æœˆäº®æˆä¸ºåœ°çƒçš„å­èŠ‚ç‚¹ç„¶åç»•åœ°çƒè¿è½¬ã€‚
åœ°çƒç»•å¤ªé˜³è¿è½¬çš„éƒ¨åˆ†åœºæ™¯å›¾ä¼šå¤„ç†ï¼Œå®ƒé€šè¿‡éå†èŠ‚ç‚¹å¹¶æŠŠçŸ©é˜µç›¸ä¹˜ï¼Œå°±åƒè¿™æ ·</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">worldMatrix = greatGrandParent * grandParent * parent * self(localMatrix)
</code></pre>
<p>æŒ‰ç…§æœ¯è¯­æˆ‘ä»¬çš„å®‡å®™å…³ç³»åº”è¯¥æ˜¯è¿™æ ·çš„</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">worldMatrixForMoon = galaxyMatrix * starMatrix * planetMatrix * moonMatrix;
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„é€’å½’å‡½æ•°æ¥å®ç°è¿™ä¸ªè¿ç®—</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">function computeWorldMatrix(currentNode, parentWorldMatrix) {
    // é€šè¿‡æŠŠæˆ‘ä»¬çš„çˆ¶èŠ‚ç‚¹çš„ä¸–ç•ŒçŸ©é˜µå’Œå½“å‰ç»“ç‚¹çš„å±€éƒ¨çŸ©é˜µç›¸ä¹˜ï¼Œ
    // è®¡ç®—å‡ºå½“å‰èŠ‚ç‚¹çš„ä¸–ç•ŒçŸ©é˜µ
    var worldMatrix = m4.multiply(parentWorldMatrix, currentNode.localMatrix);

    // è®©å­èŠ‚ç‚¹åšåŒæ ·çš„äº‹
    currentNode.children.forEach(function(child) {
        computeWorldMatrix(child, worldMatrix);
    });
}
</code></pre>
<p>è¿™é‡Œä½¿ç”¨äº†ä¸‰ç»´åœºæ™¯å›¾ä¸­å¸¸ç”¨çš„æœ¯è¯­ã€‚</p>
<ul>
<li>
<p><code class="notranslate" translate="no">localMatrix</code>: å½“å‰èŠ‚ç‚¹çš„å±€éƒ¨çŸ©é˜µã€‚å®ƒä¼šåœ¨å±€éƒ¨ç©ºé—´çš„åŸç‚¹å¯¹è‡ªå·±å’Œå­èŠ‚ç‚¹è¿›è¡Œè½¬æ¢æ“ä½œã€‚</p>
</li>
<li>
<p><code class="notranslate" translate="no">worldMatrix</code>: å°†å½“å‰ç»“ç‚¹çš„å±€éƒ¨ç©ºé—´çš„å˜æ¢è½¬æ¢åˆ°åœºæ™¯å›¾æ ¹èŠ‚ç‚¹æ‰€åœ¨çš„ç©ºé—´ã€‚
æ¢å¥è¯è¯´å®ƒå°†èŠ‚ç‚¹æ”¾åœ¨äº†ä¸–ç•Œç©ºé—´ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è®¡ç®—æœˆçƒçš„ä¸–ç•ŒçŸ©é˜µï¼Œå°±ä¼šå¾—åˆ°ä¹‹å‰çœ‹åˆ°çš„æœ‰è¶£çš„è½¨é“ã€‚</p>
</li>
</ul>
<p>åœºæ™¯å›¾å¾ˆå®¹æ˜“å®ç°ï¼Œè®©æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªç®€å•çš„ <code class="notranslate" translate="no">Node</code> å¯¹è±¡ã€‚
ç»„ç»‡åœºæ™¯å›¾çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä¸çŸ¥é“å“ªç§æ˜¯æœ€å¥½çš„ï¼Œå¸¸ç”¨çš„æ–¹å¼æ˜¯æœ‰ä¸€ä¸ªå¯é€‰çš„ç»˜åˆ¶ç‰©ä½“å­—æ®µã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var node = {
   localMatrix: ...,  // å½“å‰èŠ‚ç‚¹çš„å±€éƒ¨çŸ©é˜µ
   worldMatrix: ...,  // å½“å‰ç»“ç‚¹çš„ä¸–ç•ŒçŸ©é˜µ
   children: [],      // å­èŠ‚ç‚¹åºåˆ—
   thingToDraw: ??,   // å½“å‰èŠ‚ç‚¹éœ€è¦ç»˜åˆ¶çš„ç‰©ä½“
};
</code></pre>
<p>æˆ‘ä»¬æ¥åšä¸€ä¸ªå¤ªé˜³ç³»çš„åœºæ™¯å›¾ï¼Œä¸ºäº†ä¿æŒç®€æ´æˆ‘ä¸ä¼šä½¿ç”¨çº¹ç†ã€‚
å…ˆæ¥åˆ›å»ºå‡ ä¸ªæ–¹æ³•æ¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†èŠ‚ç‚¹ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªèŠ‚ç‚¹ç±»</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var Node = function() {
  this.children = [];
  this.localMatrix = m4.identity();
  this.worldMatrix = m4.identity();
};
</code></pre>
<p>æä¾›ä¸€ä¸ªè®¾å®šèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹å¼ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">Node.prototype.setParent = function(parent) {
  // ä»çˆ¶èŠ‚ç‚¹ä¸­ç§»é™¤
  if (this.parent) {
    var ndx = this.parent.children.indexOf(this);
    if (ndx &gt;= 0) {
      this.parent.children.splice(ndx, 1);
    }
  }

  // æ·»åŠ åˆ°æ–°çš„çˆ¶èŠ‚ç‚¹ä¸Š
  if (parent) {
    parent.children.push(this);
  }
  this.parent = parent;
};
</code></pre>
<p>è¿™æ®µä»£ç æ ¹æ®çˆ¶å­èŠ‚ç‚¹å…³ç³»å’Œå±€éƒ¨çŸ©é˜µè®¡ç®—ä¸–ç•ŒçŸ©é˜µã€‚å¦‚æœæˆ‘ä»¬ä»çˆ¶èŠ‚ç‚¹è°ƒç”¨ï¼Œ
å®ƒå°†ä¼šé€’å½’çš„è®¡ç®—å‡ºå­èŠ‚ç‚¹çš„ä¸–ç•ŒçŸ©é˜µã€‚å¦‚æœä½ å¯¹çŸ©é˜µè¿ç®—ä¸å¤ªäº†è§£
<a href="webgl-2d-matrices.html">å¯ä»¥çœ‹çœ‹è¿™ä¸ªæ–‡ç« </a>ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">Node.prototype.updateWorldMatrix = function(parentWorldMatrix) {
  if (parentWorldMatrix) {
    // ä¼ å…¥ä¸€ä¸ªçŸ©é˜µè®¡ç®—å‡ºä¸–ç•ŒçŸ©é˜µå¹¶å­˜å…¥ `this.worldMatrix`ã€‚
    m4.multiply(parentWorldMatrix, this.localMatrix, this.worldMatrix);
  } else {
    // æ²¡æœ‰çŸ©é˜µä¼ å…¥ï¼Œç›´æ¥å°†å±€éƒ¨çŸ©é˜µæ‹·è´åˆ°ä¸–ç•ŒçŸ©é˜µ
    m4.copy(this.localMatrix, this.worldMatrix);
  }

  // è®¡ç®—æ‰€æœ‰çš„å­èŠ‚ç‚¹
  var worldMatrix = this.worldMatrix;
  this.children.forEach(function(child) {
    child.updateWorldMatrix(worldMatrix);
  });
};
</code></pre>
<p>ä¸ºäº†ç®€å•æˆ‘ä»¬åªåŒ…å«å¤ªé˜³ï¼Œæœˆäº®å’Œåœ°çƒï¼Œä¹Ÿä¼šä½¿ç”¨å‡çš„è·ç¦»ä½¿å†…å®¹ä¾¿äºå‘ˆç°åœ¨å±å¹•ä¸Šã€‚
æˆ‘ä»¬ä¼šç”¨é»„è‰²çš„çƒä½“ä»£è¡¨å¤ªé˜³ï¼Œè“ç»¿è‰²çš„çƒä½“ä»£è¡¨åœ°çƒï¼Œç°è‰²çš„ä»£è¡¨æœˆäº®ã€‚
å¦‚æœä½ å¯¹ <code class="notranslate" translate="no">drawInfo</code>, <code class="notranslate" translate="no">bufferInfo</code>, å’Œ <code class="notranslate" translate="no">programInfo</code> æ„Ÿåˆ°é™Œç”Ÿå¯ä»¥
<a href="webgl-drawing-multiple-things.html">çœ‹çœ‹å‰ä¸€ç¯‡æ–‡ç« </a>ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// å®šä¹‰æ‰€æœ‰çš„èŠ‚ç‚¹
var sunNode = new Node();
sunNode.localMatrix = m4.translation(0, 0, 0);  // å¤ªé˜³åœ¨ä¸­å¿ƒ
sunNode.drawInfo = {
  uniforms: {
    u_colorOffset: [0.6, 0.6, 0, 1], // é»„è‰²
    u_colorMult:   [0.4, 0.4, 0, 1],
  },
  programInfo: programInfo,
  bufferInfo: sphereBufferInfo,
  vertexArray: sphereVAO,
};

var earthNode = new Node();
earthNode.localMatrix = m4.translation(100, 0, 0);  // åœ°çƒç¦»å¤ªé˜³ 100 ä¸ªå•ä½è·ç¦»
earthNode.drawInfo = {
  uniforms: {
    u_colorOffset: [0.2, 0.5, 0.8, 1],  // è“ç»¿è‰²
    u_colorMult:   [0.8, 0.5, 0.2, 1],
  },
  programInfo: programInfo,
  bufferInfo: sphereBufferInfo,
  vertexArray: sphereVAO,
};

var moonNode = new Node();
moonNode.localMatrix = m4.translation(20, 0, 0);  // æœˆäº®ç¦»åœ°çƒ 20 ä¸ªå•ä½è·ç¦»
moonNode.drawInfo = {
  uniforms: {
    u_colorOffset: [0.6, 0.6, 0.6, 1],  // ç°è‰²
    u_colorMult:   [0.1, 0.1, 0.1, 1],
  },
  programInfo: programInfo,
  bufferInfo: sphereBufferInfo,
  vertexArray: sphereVAO,
};
</code></pre>
<p>ç°åœ¨å°†å®ƒä»¬å…³è”èµ·æ¥</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// connect the celestial objects
moonNode.setParent(earthNode);
earthNode.setParent(sunNode);
</code></pre>
<p>åŒæ ·åˆ›å»ºä¸€ä¸ªç‰©ä½“åˆ—è¡¨å’Œä¸€ä¸ªå°†è¦ç»˜åˆ¶çš„ç‰©ä½“åˆ—è¡¨</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var objects = [
  sunNode,
  earthNode,
  moonNode,
];

var objectsToDraw = [
  sunNode.drawInfo,
  earthNode.drawInfo,
  moonNode.drawInfo,
];
</code></pre>
<p>æ¸²æŸ“æ—¶æ›´æ–°æ¯ä¸ªç‰©ä½“çš„å±€éƒ¨çŸ©é˜µæ¥æ—‹è½¬æ¯ä¸ªç‰©ä½“</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// æ›´æ–°æ¯ä¸ªç‰©ä½“çš„å±€éƒ¨çŸ©é˜µ
m4.multiply(m4.yRotation(0.01), sunNode.localMatrix  , sunNode.localMatrix);
m4.multiply(m4.yRotation(0.01), earthNode.localMatrix, earthNode.localMatrix);
m4.multiply(m4.yRotation(0.01), moonNode.localMatrix , moonNode.localMatrix);
</code></pre>
<p>å±€éƒ¨çŸ©é˜µæ›´æ–°äº†å°±å¯ä»¥æ›´æ–°ä¸–ç•ŒçŸ©é˜µ</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">sunNode.updateWorldMatrix();
</code></pre>
<p>æœ€åå°†ä¸–ç•ŒçŸ©é˜µå’ŒæŠ•å½±è§†å›¾çŸ©é˜µç›¸ä¹˜å¾—åˆ°æ¯ä¸ªç‰©ä½“çš„<a href="webgl-3d-perspective.html">ä¸–ç•Œè§†å›¾æŠ•å½±çŸ©é˜µ</a>ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// è®¡ç®—æ¯ä¸ªç‰©ä½“çš„çŸ©é˜µ
objects.forEach(function(object) {
  object.drawInfo.uniforms.u_matrix = m4.multiply(viewProjectionMatrix, object.worldMatrix);
});
</code></pre>
<p>æ¸²æŸ“è¿‡ç¨‹ä½¿<a href="webgl-drawing-multiple-things.html">ä¸ŠèŠ‚ä¸­ç›¸ä¼¼çš„å¾ªç¯</a>ã€‚</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-scene-graph-solar-system.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-scene-graph-solar-system.html" target="_blank">ç‚¹æ­¤åœ¨æ–°çª—å£ä¸­æµè§ˆ</a>
</div>

</p>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°æ‰€æœ‰çš„æ˜Ÿä½“çš„å¤§å°æ˜¯ä¸€æ ·çš„ï¼Œè®©åœ°çƒå˜å¤§ä¸€ç‚¹å§</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// åœ°çƒç¦»å¤ªé˜³ 100 ä¸ªå•ä½è·ç¦»
earthNode.localMatrix = m4.translation(100, 0, 0));

// è®©åœ°çƒå˜ä¸ºä¸¤å€å¤§å°
earthNode.localMatrix = m4.scale(earthNode.localMatrix, 2, 2, 2);
</code></pre>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-scene-graph-solar-system-larger-earth.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-scene-graph-solar-system-larger-earth.html" target="_blank">ç‚¹æ­¤åœ¨æ–°çª—å£ä¸­æµè§ˆ</a>
</div>

</p>
<p>å‘ƒï¼Œæœˆäº®ä¹Ÿå˜å¤§äº†ã€‚æƒ³è¦ä¿®å¤è¿™ä¸ªé—®é¢˜çš„è¯å°±éœ€è¦æ‰‹åŠ¨ç¼©å°æœˆäº®ã€‚
ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•å°±æ˜¯ä¸ºåœºæ™¯å›¾æ·»åŠ æ›´å¤šèŠ‚ç‚¹ã€‚è€Œä¸æ˜¯åªæ˜¯</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">  sun
   |
  earth
   |
  moon
</code></pre>
<p>æˆ‘ä»¬å°†å®ƒå˜æˆ</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no"> solarSystem
   |    |
   |   sun
   |
 earthOrbit
   |    |
   |  earth
   |
  moonOrbit
      |
     moon
</code></pre>
<p>è¿™æ ·å°±è®©åœ°çƒç»• solarSystem è½¬åŠ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å•ç‹¬æ—‹è½¬å’Œç¼©æ”¾å¤ªé˜³å¹¶ä¸”ä¸ä¼šå½±å“åˆ°åœ°çƒï¼Œ
åŒæ ·çš„åœ°çƒå¯ä»¥ç‹¬ç«‹äºæœˆçƒè½¬åŠ¨ã€‚è®©æˆ‘ä»¬ç»™ <code class="notranslate" translate="no">solarSystem</code>, <code class="notranslate" translate="no">earthOrbit</code> å’Œ <code class="notranslate" translate="no">moonOrbit</code>
å®šä¹‰èŠ‚ç‚¹ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var solarSystemNode = new Node();
var earthOrbitNode = new Node();

// åœ°çƒè½¨é“ç¦»å¤ªé˜³ 100 ä¸ªå•ä½è·ç¦»
earthOrbitNode.localMatrix = m4.translation(100, 0, 0);
var moonOrbitNode = new Node();

 // æœˆçƒç¦»å¤ªé˜³ 20 ä¸ªå•ä½è·ç¦»
moonOrbitNode.localMatrix = m4.translation(20, 0, 0);
</code></pre>
<p>è½¨é“è·ç¦»å°†ä»åŸå§‹èŠ‚ç‚¹ä¸­ç§»é™¤</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var earthNode = new Node();
-// åœ°çƒç¦»å¤ªé˜³ 100 ä¸ªå•ä½è·ç¦»
-earthNode.localMatrix = m4.translation(100, 0, 0));

-// è®©åœ°çƒå˜ä¸ºä¸¤å€å¤§å°
-earthNode.localMatrix = m4.scale(earthNode.localMatrix, 2, 2, 2);
+earthNode.localMatrix = m4.scaling(2, 2, 2);

var moonNode = new Node();
-moonNode.localMatrix = m4.translation(20, 0, 0);  // æœˆäº®ç¦»åœ°çƒ 20 ä¸ªå•ä½è·ç¦»
</code></pre>
<p>åƒè¿™æ ·è¿æ¥å®ƒä»¬</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// å…³è”ç‰©ä½“
sunNode.setParent(solarSystemNode);
earthOrbitNode.setParent(solarSystemNode);
earthNode.setParent(earthOrbitNode);
moonOrbitNode.setParent(earthOrbitNode);
moonNode.setParent(moonOrbitNode);
</code></pre>
<p>åªéœ€è¦æ›´æ–°è½¨é“</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// æ›´æ–°æ¯ä¸ªç‰©ä½“çš„å±€éƒ¨çŸ©é˜µ
-m4.multiply(m4.yRotation(0.01), sunNode.localMatrix  , sunNode.localMatrix);
-m4.multiply(m4.yRotation(0.01), earthNode.localMatrix, earthNode.localMatrix);
-m4.multiply(m4.yRotation(0.01), moonNode.localMatrix , moonNode.localMatrix);
+m4.multiply(m4.yRotation(0.01), earthOrbitNode.localMatrix, earthOrbitNode.localMatrix);
+m4.multiply(m4.yRotation(0.01), moonOrbitNode.localMatrix, moonOrbitNode.localMatrix);

// æ›´æ–°åœºæ™¯å›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ä¸–ç•ŒçŸ©é˜µ
-sunNode.updateWorldMatrix();
+solarSystemNode.updateWorldMatrix();
</code></pre>
<p>ä½ ä¼šçœ‹åˆ°åœ°çƒæ˜¯ä¸¤å€å¤§å°ï¼Œæœˆçƒä¸æ˜¯ã€‚</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-scene-graph-solar-system-larger-earth-fixed.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-scene-graph-solar-system-larger-earth-fixed.html" target="_blank">ç‚¹æ­¤åœ¨æ–°çª—å£ä¸­æµè§ˆ</a>
</div>

</p>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°å¤ªé˜³å’Œåœ°çƒä¸ä¼šåŒæ­¥è½¬åŠ¨äº†ï¼Œç°åœ¨å®ƒä»¬æ˜¯ç‹¬ç«‹çš„ã€‚</p>
<p>è®©æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">-sunNode.localMatrix = m4.translation(0, 0, 0);  // å¤ªé˜³åœ¨ä¸­å¿ƒ
+sunNode.localMatrix = m4.scaling(5, 5, 5);

...

*moonOrbitNode.localMatrix = m4.translation(30, 0, 0);

...

+moonNode.localMatrix = m4.scaling(0.4, 0.4, 0.4);

...
// æ›´æ–°æ¯ä¸ªç‰©ä½“çš„å±€éƒ¨çŸ©é˜µ
m4.multiply(m4.yRotation(0.01), earthOrbitNode.localMatrix, earthOrbitNode.localMatrix);
m4.multiply(m4.yRotation(0.01), moonOrbitNode.localMatrix, moonOrbitNode.localMatrix);
+// æ—‹è½¬å¤ªé˜³
+m4.multiply(m4.yRotation(0.005), sunNode.localMatrix, sunNode.localMatrix);
+// æ—‹è½¬åœ°çƒ
+m4.multiply(m4.yRotation(0.05), earthNode.localMatrix, earthNode.localMatrix);
+// æ—‹è½¬æœˆäº®
+m4.multiply(m4.yRotation(-0.01), moonNode.localMatrix, moonNode.localMatrix);
</code></pre>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-scene-graph-solar-system-adjusted.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-scene-graph-solar-system-adjusted.html" target="_blank">ç‚¹æ­¤åœ¨æ–°çª—å£ä¸­æµè§ˆ</a>
</div>

</p>
<p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ª <code class="notranslate" translate="no">localMatrix</code> å¹¶ä¸”æ¯ä¸€å¸§éƒ½ä¼šä¿®æ”¹ï¼Œè¿™æ ·ä¼šåœ¨è¿ç®—è¿‡ç¨‹ä¸­ä¸æ–­ç´¯ç§¯é”™è¯¯ã€‚
æœ‰ä¸€ä¸ªè§£å†³æ–¹æ³•å«åš<strong>æ­£äº¤å½’ä¸€åŒ–çŸ©é˜µ</strong>ï¼Œå°±ç®—è¿™æ ·ä¹Ÿä¸æ˜¯ç»å¯¹æ²¡é—®é¢˜ã€‚ä¾‹å¦‚æˆ‘ä»¬ç¼©æ”¾åˆ° 0 å†æ¢å¤ï¼Œ
åªå¯¹ä¸€ä¸ª <code class="notranslate" translate="no">x</code> å€¼æ–½åŠ å˜æ¢</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">x = 246;       // frame #0, x = 246

scale = 1;
x = x * scale  // frame #1, x = 246

scale = 0.5;
x = x * scale  // frame #2, x = 123

scale = 0;
x = x * scale  // frame #3, x = 0

scale = 0.5;
x = x * scale  // frame #4, x = 0  OOPS!

scale = 1;
x = x * scale  // frame #5, x = 0  OOPS!
</code></pre>
<p>æœ€åä¼šä¸¢å¤±å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å…¶ä»–çš„ç±»ä»å¤–éƒ¨æ›´æ–°çŸ©é˜µã€‚è®©æˆ‘ä»¬ç»™ <code class="notranslate" translate="no">Node</code> çš„å®šä¹‰ä¸­æ·»åŠ ä¸€ä¸ª <code class="notranslate" translate="no">source</code>ã€‚
å¦‚æœ <code class="notranslate" translate="no">source</code> å­˜åœ¨å°±ä»å®ƒé‚£é‡Œè·å–å±€éƒ¨çŸ©é˜µã€‚</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">*var Node = function(source) {
  this.children = [];
  this.localMatrix = makeIdentity();
  this.worldMatrix = makeIdentity();
+  this.source = source;
};

Node.prototype.updateWorldMatrix = function(matrix) {

+  var source = this.source;
+  if (source) {
+    source.getMatrix(this.localMatrix);
+  }

  ...
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæºã€‚é€šå¸¸ä¸€ä¸ªæºä¼šæä¾›å¹³ç§»ï¼Œæ—‹è½¬å’Œç¼©æ”¾å˜æ¢ï¼Œå°±åƒè¿™æ ·</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var TRS = function() {
  this.translation = [0, 0, 0];
  this.rotation = [0, 0, 0];
  this.scale = [1, 1, 1];
};

TRS.prototype.getMatrix = function(dst) {
  dst = dst || new Float32Array(16);
  var t = this.translation;
  var r = this.rotation;
  var s = this.scale;

  // é€šè¿‡å¹³ç§»ï¼Œæ—‹è½¬å’Œç¼©æ”¾è®¡ç®—çŸ©é˜µ
  m4.translation(t[0], t[1], t[2], dst);
  m4.xRotate(dst, r[0], dst);
  m4.yRotate(dst, r[1], dst);
  m4.zRotate(dst, r[2], dst);
  m4.scale(dst, s[0], s[1], s[2]), dst);
  return dst;
};
</code></pre>
<p>ç„¶åè¿™æ ·ä½¿ç”¨å®ƒ</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// åœ¨åˆå§‹åŒ–é˜¶æ®µç”¨æºåˆå§‹åŒ–èŠ‚ç‚¹
var someTRS  = new TRS();
var someNode = new Node(someTRS);

// æ¸²æŸ“é˜¶æ®µ
someTRS.rotation[2] += elapsedTime;
</code></pre>
<p>ç°åœ¨å°±ä¸ä¼šæœ‰é—®é¢˜äº†ï¼Œå› ä¸ºæ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çŸ©é˜µã€‚</p>
<p>ä½ å¯èƒ½å›æƒ³æˆ‘åˆä¸åšå¤ªé˜³ç³»ï¼Œåœºæ™¯å›¾æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ
å¦‚æœä½ æƒ³åŠ¨ç”»ä¸€ä¸ªäººç‰©å°±å¯èƒ½éœ€è¦è¿™æ ·ä¸€ä¸ªåœºæ™¯å›¾</p>
<p><div class="webgl_diagram_container">
  <iframe class="webgl_example " style="width: 400px; height: 400px;" src="/webgl/lessons/resources/person-diagram.html"></iframe>
</div>

</p>
<p>ä½ æƒ³ç»™æ‰‹æŒ‡å’Œè„šè¶¾ä½¿ç”¨å‡ ä¸ªå…³èŠ‚å¯ä»¥è‡ªå·±å†³å®šï¼Œå…³èŠ‚è¶Šå¤šåŠ¨ç”»çš„çµæ´»æ€§è¶Šå¼ºï¼Œæ‰€éœ€è¦çš„è¿åŠ¨æ•°æ®ä¹Ÿè¶Šå¤šã€‚
è€ä¸€ç‚¹çš„æ¸¸æˆä¾‹å¦‚ Virtua Fighter æœ‰å¤§çº¦ 15 ä¸ªå…³èŠ‚ã€‚äºŒåä¸–çºªä¸­å¶çš„æ¸¸æˆæœ‰ 30 åˆ° 70
ä¸ªå…³èŠ‚ã€‚å¦‚æœæŠŠæ‰‹çš„æ¯ä¸ªå…³èŠ‚éƒ½åšçš„è¯ä¸€ä¸ªæ‰‹å°±æœ‰è‡³å°‘ 20 ä¸ªå…³èŠ‚ï¼Œä¸¤ä¸ªæ‰‹å°±æœ‰ 40 ä¸ªï¼Œ
å¤§å¤šæ•°æ¸¸æˆå¤§æ‹‡æŒ‡ä½¿ç”¨ä¸€ä¸ªå…³èŠ‚ï¼Œå…¶ä»–å››ä¸ªæ‰‹æŒ‡ä½¿ç”¨ä¸€ä¸ªå…³èŠ‚ï¼Œä»¥ä¾¿èŠ‚çº¦æ—¶é—´ï¼ˆGPU/CPU å’Œ ç¾å·¥çš„æ—¶é—´ï¼‰å’Œå†…å­˜ã€‚</p>
<p>è¿™é‡Œæœ‰æˆ‘åšçš„ä¸€ä¸ªæ–¹å—äººçš„ä¾‹å­ï¼Œå®ƒçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ç”¨åˆ°äº†ä¸Šæ–¹çš„ <code class="notranslate" translate="no">TRS</code>ï¼Œç¨‹åºå‘˜çš„ç¾æœ¯å’ŒåŠ¨ç”»èƒ½åŠ›ç®€ç›´äº†ï¼ FTW! ğŸ˜‚</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-scene-graph-block-guy.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-scene-graph-block-guy.html" target="_blank">ç‚¹æ­¤åœ¨æ–°çª—å£ä¸­æµè§ˆ</a>
</div>

</p>
<p>ä½ ä¼šåœ¨å¾ˆå¤šä¸‰ç»´åº“ä¸­æ‰¾åˆ°ç±»ä¼¼è¿™æ ·çš„åœºæ™¯å›¾ã€‚
è‡³äºæ„å»ºå±‚æ¬¡ç»“æ„ï¼Œå®ƒä»¬é€šå¸¸æ˜¯é€šè¿‡æŸç§å»ºæ¨¡åŒ…æˆ–å…³å¡å¸ƒå±€åŒ…åˆ›å»ºçš„ã€‚</p>
<div class="webgl_bottombar">
<h3>SetParent vs AddChild / RemoveChild</h3>
<p>å¤§å¤šæ•°åœºæ™¯å›¾æœ‰ä¸€ä¸ª <code class="notranslate" translate="no">node.addChild</code> æ–¹æ³•å’Œä¸€ä¸ª
 <code class="notranslate" translate="no">node.removeChild</code>
æ–¹æ³•ï¼Œè€Œæˆ‘åœ¨ä¸Šæ–¹å®šä¹‰äº†ä¸€ä¸ª <code class="notranslate" translate="no">node.setParent</code> æ–¹æ³•ã€‚
å“ªç§æ–¹å¼æ›´å¥½ï¼Ÿç†è®ºä¸Šåªæ˜¯é£æ ¼ä¸åŒï¼Œä½†æ˜¯æˆ‘æœ‰ä¸€ä¸ªå®¢è§‚çš„ç†ç”±è¯æ˜
<code class="notranslate" translate="no">setParent</code> æ¯” <code class="notranslate" translate="no">addChild</code> è¦å¥½ä¸€äº›ï¼Œå› ä¸ºå®ƒå¯ä»¥è®©ä»£ç è¿™æ ·å†™ã€‚</p>
<pre class="prettyprint">
    someParent.addChild(someNode);
    ...
    someOtherParent.addChild(someNode);
</pre>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ <code class="notranslate" translate="no">someNode</code> æ˜¯å¦åŒæ—¶å­˜åœ¨äº <code class="notranslate" translate="no">someParent</code> å’Œ <code class="notranslate" translate="no">someOtherParent</code> ä¹‹ä¸­å‘¢?
å¤§å¤šæ•°åœºæ™¯å›¾ä¸­è¿™æ˜¯ä¸åˆç†çš„ï¼Œé‚£ç¬¬äºŒæ¬¡è°ƒç”¨çš„æ—¶å€™ä¼šäº§ç”Ÿé”™è¯¯ä¹ˆï¼Ÿ
<code class="notranslate" translate="no">ERROR: Already have parent</code>ã€‚åœ¨ <code class="notranslate" translate="no">someNode</code> 
æ·»åŠ åˆ° <code class="notranslate" translate="no">someOtherParent</code> ä¹‹å‰å®ƒè‡ªåŠ¨ä» <code class="notranslate" translate="no">someParent</code> ç§»é™¤äº†ä¹ˆï¼Ÿ
å¦‚æœç§»é™¤äº†é‚£ä¹ˆ <code class="notranslate" translate="no">addChild</code> å°±ä¸æ˜¯ä¸€ä¸ªæ¸…æ™°çš„æ–¹æ³•åã€‚
</p>
<p><code class="notranslate" translate="no">setParent</code> å°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜</p>
<pre class="prettyprint">
    someNode.setParent(someParent);
    ...
    someNode.setParent(someOtherParent);
</pre>
<p>
åœ¨è¿™ä¸ªæƒ…å†µä¸‹å®ƒæ˜¯ 100% æ˜ç¡®çš„ï¼Œæ²¡æœ‰æ­§ä¹‰ã€‚
</div>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-scene-graph.html" >English</a>
    <option value="/webgl/lessons/de/webgl-scene-graph.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl-scene-graph.html" >æ—¥æœ¬èª</a>
    <option value="/webgl/lessons/ko/webgl-scene-graph.html" >í•œêµ­ì–´</a>
    <option value="/webgl/lessons/pt-br/webgl-scene-graph.html" >PortuguÃªs Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl-scene-graph.html" >Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
    <option value="/webgl/lessons/zh_cn/webgl-scene-graph.html" selected>ç®€ä½“ä¸­æ–‡</a>
</select>


        <div id="toc">
          <ul>  <li>åŸºç¡€æ¦‚å¿µ</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-getting-webgl2.html">æ€æ ·ä½¿ç”¨WebGL2</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-fundamentals.html">åŸºæœ¬åŸç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-how-it-works.html">å¦‚ä½•å·¥ä½œçš„</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-shaders-and-glsl.html">ç€è‰²å™¨å’Œ GLSL è¯­è¨€</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html?lang=zh_cn">WebGL2 State Diagram</a></li>
        </ul>
  <li>WebGL2 vs WebGL1</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl2-whats-new.html">WebGL2æœ‰ä»€ä¹ˆæ–°å†…å®¹</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl1-to-webgl2.html">è¿ç§»WebGL1åˆ°WebGL2</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl1-to-webgl2-fundamentals.html">WebGLFundamentals.orgå’ŒWebGL2Fundamentals.orgçš„åŒºåˆ«</a></li>
        </ul>
  <li>å›¾åƒå¤„ç†</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-image-processing.html">å›¾åƒå¤„ç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-image-processing-continued.html">è¿›ä¸€æ­¥å¤„ç†å›¾åƒ</a></li>
        </ul>
  <li>äºŒç»´å¹³ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾å’ŒçŸ©é˜µè¿ç®—</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-2d-translation.html">äºŒç»´å¹³ç§»</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-rotation.html">äºŒç»´æ—‹è½¬</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-scale.html">äºŒç»´ç¼©æ”¾</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-matrices.html">äºŒç»´çŸ©é˜µ</a></li>
        </ul>
  <li>ä¸‰ç»´</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-orthographic.html">ä¸‰ç»´æ­£å°„æŠ•å½±</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective.html">ä¸‰ç»´é€è§†æŠ•å½±</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-camera.html">ä¸‰ç»´ç›¸æœº</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-matrix-naming.html">WebGL2 ä¸‰ç»´çŸ©é˜µå‘½å</a></li>
        </ul>
  <li>å…‰ç…§</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-directional.html">ä¸‰ç»´æ–¹å‘å…‰æº</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-point.html">ç‚¹å…‰æº</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-spot.html">èšå…‰ç¯</a></li>
        </ul>
  <li>ç»„ç»‡å’Œé‡æ„</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-less-code-more-fun.html">ç å°‘è¶£å¤š</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html">ç»˜åˆ¶å¤šä¸ªç‰©ä½“</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-scene-graph.html">åœºæ™¯å›¾</a></li>
        </ul>
  <li>å‡ ä½•</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-geometry-lathe.html">ä¸‰ç»´å‡ ä½•åŠ å·¥</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-load-obj.html">åŠ è½½ .obj æ–‡ä»¶</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-load-obj-w-mtl.html">åŠ è½½å¸¦ .mtl çš„ .obj æ–‡ä»¶</a></li>
        </ul>
  <li>çº¹ç†</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-3d-textures.html">çº¹ç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-data-textures.html">æ•°æ®çº¹ç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2-textures.html">ä½¿ç”¨å¤šä¸ªçº¹ç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-cors-permission.html">è·¨åŸŸå›¾åƒ</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective-correct-texturemapping.html">çº¹ç†æ˜ å°„çš„é€è§†çº æ­£</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-planar-projection-mapping.html">å¹³é¢çš„å’Œé€è§†çš„æŠ•å½±æ˜ å°„</a></li>
        </ul>
  <li>æ¸²æŸ“åˆ°çº¹ç†</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-render-to-texture.html">æ¸²æŸ“åˆ°çº¹ç†</a></li>
        </ul>
  <li>é˜´å½±</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-shadows.html">é˜´å½±</a></li>
        </ul>
  <li>æŠ€æœ¯</li>
        <ul>
            <li>äºŒç»´</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-2d-drawimage.html">äºŒç»´ DrawImage</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-matrix-stack.html">äºŒç»´çŸ©é˜µæ ˆ</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-sprites.html">ç²¾çµ</a></li>
        </ul>
  <li>ä¸‰ç»´</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-cube-maps.html">WebGL2 ç«‹æ–¹ä½“è´´å›¾</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-environment-maps.html">WebGL2 ç¯å¢ƒè´´å›¾</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-skybox.html">WebGL2 å¤©ç©ºç›’</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-skinning.html">WebGL2 è’™çš®</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-fog.html">WebGL2 é›¾</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-picking.html">æ‹¾å–ï¼ˆç‚¹å‡»ç‰©ä½“ï¼‰</a></li>
        </ul>
  <li>æ–‡å­—</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-text-html.html">æ–‡å­— - HTML</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-canvas2d.html">æ–‡å­— - äºŒç»´ Canvas</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-texture.html">æ–‡å­— - ä½¿ç”¨çº¹ç†</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-text-glyphs.html">æ–‡å­— - ä½¿ç”¨å­—å½¢çº¹ç†</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-gpgpu.html">é€šç”¨GPUè®¡ç®—(GPGPU)</a></li>
        </ul>
        </ul>
  <li>æŠ€å·§</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-smallest-programs.html">æœ€å°çš„ç¨‹åº</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-drawing-without-data.html">æ— æ•°æ®ç»˜åˆ¶</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-pulling-vertices.html">é¡¶ç‚¹æ‹‰å–</a></li>
        </ul>
  <li>ä¼˜åŒ–</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-indexed-vertices.html">é¡¶ç‚¹ç´¢å¼• (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-instanced-drawing.html">å®ä¾‹åŒ–ç»˜åˆ¶</a></li>
        </ul>
  <li>æ‚é¡¹</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-setup-and-installation.html">è®¾ç½®å’Œå®‰è£…</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-boilerplate.html">æ ·æ¿</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-resizing-the-canvas.html">é‡ç½®ç”»å¸ƒå°ºå¯¸</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-animation.html">åŠ¨ç”»</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-points-lines-triangles.html">ç‚¹ã€çº¿æ®µä¸ä¸‰è§’å½¢</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-multiple-views.html">å¤šè§†å›¾ä¸å¤šç”»å¸ƒ</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-visualizing-the-camera.html">å¯è§†åŒ–ç›¸æœº</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-and-alpha.html">WebGL2 å’Œ Alpha</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-2d-vs-3d-library.html">2D vs 3D åº“</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-anti-patterns.html">åæ¨¡å¼</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-matrix-vs-math.html">WebGL2ä¸­çš„çŸ©é˜µvsæ•°å­¦ä¸­çš„çŸ©é˜µ</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-precision-issues.html">ç²¾åº¦é—®é¢˜</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-tips.html#html-background">Use WebGL2 as Background in HTML</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-cross-platform-issues.html">è·¨å¹³å°é—®é¢˜</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-qna.html">Questions and Answers</a></li>
        </ul>
  <li>å‚è€ƒ</li>
        <ul>
          <li><a href="/webgl/lessons/zh_cn/webgl-attributes.html">å±æ€§ï¼ˆAttributesï¼‰</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-texture-units.html">çº¹ç†å•å…ƒï¼ˆTexture Unitsï¼‰</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-framebuffers.html">å¸§ç¼“å†²åŒºï¼ˆFramebuffersï¼‰</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/zh_cn/webgl-references.html">å‚è€ƒèµ„æ–™</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">APIå¸®åŠ©æ–‡æ¡£</a></li>
  <li><a href="https://twgljs.org">TWGLï¼Œä¸€ä¸ªè½»é‡çº§WebGLè¾…åŠ©åº“</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">GitHub</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        
<div>æœ‰æ„è§æˆ–å»ºè®®? <a href="https://github.com/gfxfundamentals/webgl2-fundamentals/issues">åœ¨GitHubä¸Šæissue</a>.</div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webgl2fundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL2 - åœºæ™¯å›¾';
            var disqus_title = 'WebGL2 - åœºæ™¯å›¾';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webgl2fundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "æ„Ÿè°¢ <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>çš„ <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} ä¸ªè´¡çŒ®</a>",
  owner: "gfxfundamentals",
  repo: "webgl2-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
</script>


</html>




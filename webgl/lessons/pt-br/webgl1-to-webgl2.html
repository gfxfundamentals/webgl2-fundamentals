<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/pt-br/webgl1-to-webgl2.md. Do not edited directly -->
<!--
Copyright 2021, GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Como passar da WebGL1 para a WebGL2">
<meta name="keywords" content="webgl webgl2 graphics">
<meta name="thumbnail" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_pt-br.jpg">

<meta property="og:title" content="WebGL2 para a WebGL1">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_pt-br.jpg">
<meta property="og:description" content="Como passar da WebGL1 para a WebGL2">
<meta property="og:url" content="https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webgl2fundamentals.org">
<meta name="twitter:title" content="WebGL2 para a WebGL1">
<meta name="twitter:url" content="https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html">
<meta name="twitter:description" content="Como passar da WebGL1 para a WebGL2">
<meta name="twitter:image:src" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_pt-br.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webgl2fundamentals.org/#website",
      "url":"https://webgl2fundamentals.org/",
      "name":"Webgl2Fundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html#primaryimage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_pt-br.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html#webpage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html",
      "inLanguage":"pt-br",
      "name":"WebGL2 para a WebGL1",
      "keywords":"webgl webgl2 graphics programming",
      "isPartOf":{
        "@id":"https://webgl2fundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webgl2fundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL2 para a WebGL1</title>
<link href="/webgl/lessons/resources/webgl2fundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="de" href="https://webglfundamentals.org/webgl/lessons/de/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl1-to-webgl2.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl1-to-webgl2.html" >English</a>
    <option value="/webgl/lessons/de/webgl1-to-webgl2.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl1-to-webgl2.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl1-to-webgl2.html" >한국어</a>
    <option value="/webgl/lessons/pt-br/webgl1-to-webgl2.html" selected>Português Brasileiro</a>
    <option value="/webgl/lessons/zh_cn/webgl1-to-webgl2.html" >简体中文</a>
</select>


    <a href="#toc">Índice</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/pt-br/">WebGL2Fundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL2 para a WebGL1</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>WebGL2 é quase 100% compatível com o WebGL1.
Se você usar apenas os recursos da WebGL1, então há
apenas 2 diferenças.</p>
<ol>
<li><p>Você usa <code class="notranslate" translate="no">&quot; webgl2 &quot;</code> em vez de <code class="notranslate" translate="no">&quot; webgl &quot;</code> ao chamar <code class="notranslate" translate="no">getContext</code></p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var gl = someCanvas.getContext(&quot;webgl2&quot;);
</code></pre><p>Nota: não há &quot;experimental-webgl2&quot;. Os fornecedores do navegador se
reuniram e decidiram não mais prefixar coisas porque os sites
dependem do prefixo.</p>
</li>
<li><p>Muitas extensões são uma parte padrão da WebGL2 e, portanto, não estão disponíveis
como extensões</p>
<p>Por exemplo, objeto Vertex Array <code class="notranslate" translate="no">OES_vertex_array_object</code> é uma
característica padrão da WebGL2. Então, por exemplo, na WebGL1 você faria isso</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var ext = gl.getExtension(&quot;OES_vertex_array_object&quot;);
if (!ext) {
  // Diga ao usuário que ele não têm a extensão necessária ou trabalhar em torno dela
} else {
  var someVAO = ext.createVertexArrayOES();
}
</code></pre><p>Na WebGL2 você faria isso</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var someVAO = gl.createVertexArray();
</code></pre><p>Porque ele só existe.</p>
</li>
</ol>
<p>Caso contrário, todas as suas coisas WebGL1 devem funcionar.</p>
<p>Dito isso, para tirar proveito da maioria dos recursos da WebGL2 você precisará fazer
algumas mudanças.</p>
<h2 id="mude-para-glsl-300-es">Mude para GLSL 300 es</h2>
<p>A maior mudança é que você deve atualizar seus shaders para GLSL 3,00 ES. Para
fazer isso, a primeira linha de seus shaders precisa ser</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">#version 300 es
</code></pre><p><strong>NOTA: ESTA TEM QUE SER A PRIMEIRA LINHA! Sem comentários, sem linhas em branco antes de permitir.</strong></p>
<p>Em outras palavras, isso é ruim</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// RUIM!!!!                +---Há uma nova linha aqui!
// RUIM!!!!                V
var vertexShaderSource = `
#version 300 es
..
`;
</code></pre><p>Isso também é ruim</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;!-- RUIM!!                   V&lt;- há uma nova linha aqui!
&lt;script id=&quot;vs&quot; type=&quot;notjs&quot;&gt;
#version 300 es
...
&lt;/script&gt;
</code></pre><p>Isso é bom</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var vertexShaderSource = `#version 300 es
...
`;
</code></pre><p>Isso também é bom</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;script id=&quot;vs&quot; type=&quot;notjs&quot;&gt;#version 300 es
...
&lt;/script&gt;
</code></pre><p>Ou você poderia fazer com que suas funções de compilação de shader tirem
as primeiras linhas em branco.</p>
<h3 id="mudan-as-em-glsl-300-es-de-glsl-100">Mudanças em GLSL 300 es de GLSL 100</h3>
<p>Há várias mudanças que você precisa para fazer o seus shaders
de cima para adicionar a cadeia de versão anterior</p>
<h4 id="-attribute-in-"><code class="notranslate" translate="no">attribute</code> -&gt; <code class="notranslate" translate="no">in</code></h4>
<p>No GLSL 100 você pode ter</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">attribute vec4 a_position;
attribute vec2 a_texcoord;
attribute vec3 a_normal;
</code></pre><p>Em GLSL 300 es se torna</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">in vec4 a_position;
in vec2 a_texcoord;
in vec3 a_normal;
</code></pre><h4 id="-varying-to-in-out-"><code class="notranslate" translate="no">varying</code> to <code class="notranslate" translate="no">in</code> / <code class="notranslate" translate="no">out</code></h4>
<p>No GLSL 100, você pode declarar uma variação tanto no vertex
como nos fragmentos shaders como esse</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">varying vec2 v_texcoord;
varying vec3 v_normal;
</code></pre><p>Em GLSL 300 es no vertex shader as variações se tornam</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">out vec2 v_texcoord;
out vec3 v_normal;
</code></pre><p>E no fragmento shader eles se tornam</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">in vec2 v_texcoord;
in vec3 v_normal;
</code></pre><h4 id="n-o-mais-gl_fragcolor-">Não mais <code class="notranslate" translate="no">gl_FragColor</code></h4>
<p>No GLSL 100, seu fragmento shader configuraria a variável
especial <code class="notranslate" translate="no">gl_FragColor</code> para definir a saída do shader.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl_FragColor = vec4(1, 0, 0, 1);  // red
</code></pre><p>Em GLSL 300 es, você declara sua própria variável de saída e
depois configura-a.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">out vec4 myOutputColor;

void main() {
   myOutputColor = vec4(1, 0, 0, 1);  // red
}
</code></pre><p>Nota: Você pode escolher qualquer nome que desejar, mas os nomes <strong>não</strong> podem começar
com <code class="notranslate" translate="no">gl_</code>, então você não pode simplesmente fazer <code class="notranslate" translate="no">out vec4 gl_FragColor</code></p>
<h4 id="-texture2d-texture-etc-"><code class="notranslate" translate="no">texture2D</code> -&gt; <code class="notranslate" translate="no">texture</code> etc.</h4>
<p>No GLSL 100 você obtém uma cor de uma textura como essa</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">uniform sampler2D u_some2DTexture;
uniform samplerCube u_someCubeTexture;

...

vec4 color1 = texture2D(u_some2DTexture, ...);
vec4 color2 = textureCube(u_someCubeTexture, ...);
</code></pre><p>No GLSL 300es, as funções de textura sabem automaticamente o
que fazer com base no tipo de amostrador, então agora é apenas
<code class="notranslate" translate="no">texture</code></p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">uniform sampler2D u_some2DTexture;
uniform samplerCube u_someCubeTexture;

...

vec4 color1 = texture(u_some2DTexture, ...);
vec4 color2 = texture(u_someCubeTexture, ...);
</code></pre><h2 id="caracter-sticas-que-voc-pode-dar-como-certo">Características que você pode dar como certo</h2>
<p>No WebGL1, muitos recursos eram extensões opcionais. No WebGL2,
todos os itens seguintes são características padrão</p>
<ul>
<li>Texturas de profundidade (<a href="https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/">WEBGL_depth_texture</a>)</li>
<li>Texturas de ponto flutuante (<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_float/">OES_texture_float</a>/<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_float_linear/">OES_texture_float_linear</a>)</li>
<li>Objetos Vertex Array (<a href="https://www.khronos.org/registry/webgl/extensions/OES_vertex_array_object/">OES_vertex_array_object</a>)</li>
<li>Derivados Padrão (<a href="https://www.khronos.org/registry/webgl/extensions/OES_standard_derivatives/">OES_standard_derivatives</a>)</li>
<li>Desenho Instanciado (<a href="https://www.khronos.org/registry/webgl/extensions/ANGLE_instanced_arrays/">ANGLE_instanced_arrays</a>)</li>
<li>Índices UNSIGNED_INT (<a href="https://www.khronos.org/registry/webgl/extensions/OES_element_index_uint/">OES_element_index_uint</a>)</li>
<li>Configurando <code class="notranslate" translate="no">gl_FragDepth</code> (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_frag_depth/">EXT_frag_depth</a>)</li>
<li>Misturar Equação MIN / MAX (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_blend_minmax/">EXT_blend_minmax</a>)</li>
<li>Acesso direto a textura LOD (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_shader_texture_lod/">EXT_shader_texture_lod</a>)</li>
<li>Múltiplos Draw Buffers (<a href="https://www.khronos.org/registry/webgl/extensions/WEBGL_draw_buffers/">WEBGL_draw_buffers</a>)</li>
<li>Acesso de textura no vertex shaders</li>
</ul>
<h2 id="non-power-de-2-suporte-de-textura">Non-Power de 2 Suporte de Textura</h2>
<p>nas texturas WebGL1 que não tinham um poder de 2 não podiam ter mips.
No WebGL2, esse limite é removido. Non-power de 2 texturas funciona exatamente
como a potência de 2 texturas.</p>
<h2 id="anexos-do-framebuffer-do-ponto-flutuante">Anexos do Framebuffer do ponto flutuante</h2>
<p>No WebGL1 para verificar se há suporte para a renderização para uma textura
de ponto flutuante, primeiro você verificaria e ativaria a extensão <code class="notranslate" translate="no">OES_texture_float</code>, 
então você criaria uma textura de ponto flutuante, ligaria-a a um framebuffer e chamaria
<code class="notranslate" translate="no">gl.checkFramebufferStatus</code> veja se ele retornou  <code class="notranslate" translate="no">gl.FRAMEBUFFER_COMPLETE</code>.</p>
<p>No WebGL2 você precisa verificar e ativar <code class="notranslate" translate="no">EXT_color_buffer_float</code> ou então
<code class="notranslate" translate="no">gl.checkFramebufferStatus</code> nunca retornará <code class="notranslate" translate="no">gl.FRAMEBUFFER_COMPLETE</code> para
uma textura de ponto flutuante.</p>
<p>Observe que isso também é verdadeiro para os anexos framebuffer <code class="notranslate" translate="no">HALF_FLOAT</code>.</p>
<blockquote>
<p>Se você tem curiosidade, esse foi um erro na especificação WebLG1. O que aconteceu foi o envio 
da WebGL1 e o <code class="notranslate" translate="no">OES_texture_float</code> foi adicionado e apenas assumiu que a maneira correta
de usá-lo para renderizar era criar uma textura, anexá-la um framebuffer
e verificar seu status. Mais tarde, alguém apontou de acordo com a especificação que
não era suficiente porque a especificação diz que as cores escritas em um fragmento shader são
sempre restritos de 0 a 1. <code class="notranslate" translate="no">EXT_color_buffer_float</code> remove essa restrição
de clampping, mas como o WebGL já havia sido enviado há um ano ou teria quebrado
muitos sites para reforçar a restrição. Para o WebGL2 eles conseguiram corrigi-lo
e agora você deve habilitar o <code class="notranslate" translate="no">EXT_color_buffer_float</code>
para usar as texturas de ponto flutuante como anexos framebuffer.</p>
<p>Observe que o AFAIK, a partir de março de 2017, poucos dispositivos móveis suportam renderização
para texturas de ponto flutuante.</p>
</blockquote>
<h2 id="objetos-vertex-array">Objetos Vertex Array</h2>
<p>De todos os recursos acima de um recurso, eu pessoalmente acho que você
sempre deve SEMPRE usar os objetos do vertex array. Tudo realmente
depende do que você está tentando fazer, mas os objetos do vertex array, em particular,
parecem um recurso básico que sempre deve ser usado.</p>
<p>Na WebGL1 sem objetos vertex array todos os dados sobre atributos
foram para o estado WebGL global. Você pode imaginar isso assim</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var glState = {
  attributeState: {
    ELEMENT_ARRAY_BUFFER: null,
    attributes: [
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
    ],
  },
</code></pre><p>   }</p>
<p>Chamar funções como <code class="notranslate" translate="no">gl.vertexAttribPointer</code>,<code class="notranslate" translate="no">gl.enableVertexAttribArray</code> e
<code class="notranslate" translate="no">gl.bindBuffer (gl.ELEMENT_ARRAY_BUFFER, ??)</code> afetariam esse estado global.
Antes de cada coisa que você queria desenhar, você precisava configurar todos os atributos e, se você
estivesse desenhando dados indexados, você precisava configurar o <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code>.</p>
<p>Com objeto Vertex Array, todo o <code class="notranslate" translate="no">attributeState</code> acima se torna um <em>Vertex Array</em>.</p>
<p>Em outras palavras</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var someVAO = gl.createVertexArray();
</code></pre><p>Faz uma nova instância da coisa acima chamada <code class="notranslate" translate="no">attributeState</code>.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(someVAO);
</code></pre><p>É equivalente a</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">glState.attributeState = someVAO;
</code></pre><p>O que isto significa é que você deve configurar todos os seus atributos em tempo de inicialização agora.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// no tempo inicial
for each model / geometry / ...
  var vao = gl.createVertexArray()
  gl.bindVertexArray(vao);
  for each attribute
    gl.enableVertexAttribArray(...);
    gl.bindBuffer(gl.ARRAY_BUFFER, bufferForAttribute);
    gl.vertexAttribPointer(...);
  if indexed geometry
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
  gl.bindVertexArray(null);
</code></pre><p>Então no tempo de renderização para usar uma geometria particular, tudo o que você precisa fazer 
é</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(vaoForGeometry);
</code></pre><p>No WebGL1, o objeto de loop de inicialização teria aparecido no tempo de renderização.
Esta é uma grande velocidade!</p>
<p>Há algumas advertências:</p>
<ol>
<li><p>Os locais de atributo dependem do programa.</p>
<p>Se você estiver usando a mesma geometria com vários programas,
considere atribuir manualmente locais de atributo.
No GLSL 300 es você pode fazer isso no shader</p>
<p>Por example:</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">layout(location = 0) in vec4 a_position;
layout(location = 1) in vec2 a_texcoord;
layout(location = 2) in vec3 a_normal;
layout(location = 3) in vec4 a_color;
</code></pre><p>Define os locais dos 4 atributos.</p>
<p>Você ainda pode fazer o modo WebGL1 chamando
<code class="notranslate" translate="no">gl.bindAttribLocation</code> antes de chamar <code class="notranslate" translate="no">gl.linkProgram</code>.</p>
<p>Por example:</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindAttribLocation(someProgram, 0, &quot;a_position&quot;);
gl.bindAttribLocation(someProgram, 1, &quot;a_texcoord&quot;);
gl.bindAttribLocation(someProgram, 2, &quot;a_normal&quot;);
gl.bindAttribLocation(someProgram, 3, &quot;a_color&quot;);
</code></pre><p>Isso significa que você pode forçá-los a serem compatíveis em vários programas de
shader. Se um programa não precisa de todos os atributos,
os atributos que eles precisam ainda serão atribuídos
aos mesmos locais</p>
<p>Se você não fizer isso, você precisará de VAOs diferentes
para diferentes programas de shader ao usar a mesma geometria OR,
você precisará apenas fazer a WebGL1 e não usar
VAOs e sempre configurar atributos no tempo de renderização, o que é lento.</p>
<p>NOTA: dos 2 métodos acima, eu me inclino para usar o 
<code class="notranslate" translate="no">gl.bindAttribLocation</code>  porque é fácil tê-lo em um lugar no meu código onde,
o método de usar layout <code class="notranslate" translate="no">layout(location = ?)</code> deve
estar em todos os shaders, então, no interesse de DRY <code class="notranslate" translate="no">gl.bindAttribLocation</code>
parece melhor. Talvez, se eu estivesse usando um gerador de shader, não haveria diferença.</p>
</li>
<li><p>Sempre desvincular o VAO quando terminar</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(null);
</code></pre><p>Isso só vem da minha própria experiência. Se você olhar acima, o
estado <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code> faz parte de uma Vertex Array.</p>
<p>Então, encontrei esse problema. Eu criei uma geometria, então
criei um VAO para essa geometria e configurei os atributos
e <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code>. Então criei mais
geometria. Quando essa geometria configurou seus índices, porque
eu ainda tinha o anterior VAO ligado configuração os índices
efectuados a <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code> vinculativo para o anterior
VAO. Levei várias horas para depurar.</p>
<p>Então, minha sugestão nunca é deixar um link VAO se você terminar
com isso. Ou vincule imediatamente o próximo VAO que você vai
usar ou, se tiver terminado, vincule <code class="notranslate" translate="no">null</code></p>
</li>
</ol>
<p>Essa é minha pequena lista pessoal de coisas a serem conhecidas ao mudar
de WebGL1 para WebGL2. <a href="webgl2-whats-new.html">Há ainda mais coisas que você pode fazer no WebGL2 embora</a>.</p>
<div class="webgl_bottombar">
<h3>Fazendo as extensões WebGL1 parecer WebGL2</h3>
<p>As funções que estavam em extensões no WebGL1 estão agora no contexto principal
no WebGL2. Por exemplo, no WebGL</p>
<pre class="prettyprint">
var ext = gl.getExtension("OES_vertex_array_object");
if (!ext) {
  // Diga ao usuário que ele não têm a extensão necessária ou trabalhar em torno dela
} else {
  var someVAO = ext.createVertexArrayOES();
}
</pre>
<p>
vs em webgl2
</p>
<pre class="prettyprint">
var someVAO = gl.createVertexArray();
</pre>
<p>Acomo você pode ver se você deseja que seu código seja executado tanto no WebGL1 quanto no WebGL2,
que pode apresentar alguns desafios.</p>
<p>Uma solução seria copiar extensões WebGL1 ao contexto WebGL em tempo de inicialização.
Dessa forma, o resto do seu código pode permanecer o mesmo. Exemplo:</p>
<pre class="prettyprint">
var gl = someCanvas.getContext("webgl");
var haveVAOs = getAndApplyExtension(gl, "OES_vertex_array_object"));

function getAndApplyExtension(gl, name) {
  var ext = gl.getExtension(name);
  if (!ext) {
    return false;
  }
  var suffix = name.split("_")[0];
  var prefix = suffix = '_';
  var suffixRE = new RegExp(suffix + '$');
  var prefixRE = new RegExp('^' + prefix);
  for (var key in ext) {
    var val = ext[key];
    if (typeof(val) === 'function') {
      // remover sufixo (ex: bindVertexArrayOES -> bindVertexArray)
      var unsuffixedKey = key.replace(suffixRE, '');
      if (key.substing)
      gl[unprefixedKey] = ext[key].bind(ext);
    } else {
      var unprefixedKey = key.replace(prefixRE, '');
      gl[unprefixedKey] = ext[key];
    }
  }
</pre>
<p>Agora, seu código pode funcionar da mesma forma em ambos. Exemplo:</p>
<pre class="prettyprint">
if (haveVAOs) {
  var someVAO = gl.createVertexArray();
  ...
} else {
  ... do whatever for no VAOs.
}
</pre>
<p>A alternativa seria ter que fazer algo assim</p>
<pre class="prettyprint">
if (haveVAOs) {
  if (isWebGL2)
     someVAO = gl.createVertexArray();
  } else {
     someVAO = vaoExt.createVertexArrayOES();
  }
  ...
} else {
  ... do whatever for no VAOs.
}
</pre>
<p>Nota: No caso dos objetos Vertex Array em particular, sugiro que você <a href="https://github.com/greggman/oes-vertex-array-object-polyfill">use a polyfill</a>
para que você os tenha em todos os lugares. Os VAOs estão disponíveis na maioria dos sistemas.
Aqueles poucos sistemas onde eles não estão disponíveis o polyfill irá lidar com você e seu código
pode ficar simples.</p>
</div>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl1-to-webgl2.html" >English</a>
    <option value="/webgl/lessons/de/webgl1-to-webgl2.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl1-to-webgl2.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl1-to-webgl2.html" >한국어</a>
    <option value="/webgl/lessons/pt-br/webgl1-to-webgl2.html" selected>Português Brasileiro</a>
    <option value="/webgl/lessons/zh_cn/webgl1-to-webgl2.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>Fundamentos</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-getting-webgl2.html">Como utilizar a WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-fundamentals.html">Fundamentos da WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-how-it-works.html">How It Works</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-shaders-and-glsl.html">Shaders and GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL2 State Diagram</a></li>
        </ul>
  <li>WebGL2 vs WebGL1</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl2-whats-new.html">O que há de novo na WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl1-to-webgl2.html">Migrando do WebGL1 para a WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl1-to-webgl2-fundamentals.html">Diferenças entre a WebGLFundamentals.org e a WebGL2Fundamentals.org</a></li>
        </ul>
  <li>Processamento de Imagem</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-image-processing.html">Processamento de Imagem WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-image-processing-continued.html">Processamento de Imagem Continuada WebGL2</a></li>
        </ul>
  <li>Translação 2D, rotação, escala, matriz matemática</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-2d-translation.html">Translação 2D WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2d-rotation.html">Rotação 2D WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2d-scale.html">Escala 2D WebGL2</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2d-matrices.html">2D Matrices</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-3d-orthographic.html">Orthographic 3D</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-3d-perspective.html">3D Perspective</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-3d-camera.html">3D - Cameras</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-matrix-naming.html">WebGL2 3D - Nomenclatura das Matrizes</a></li>
        </ul>
  <li>Iluminação</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-3d-lighting-directional.html">Directional Lighting</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-3d-lighting-point.html">Point Lighting</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-3d-lighting-spot.html">Spot Lighting</a></li>
        </ul>
  <li>Estrutura e Organização</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-less-code-more-fun.html">Less Code, More Fun</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-drawing-multiple-things.html">Drawing Multiple Things</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-scene-graph.html">Scene Graphs</a></li>
        </ul>
  <li>Geometria</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-3d-geometry-lathe.html">3D Geometry - Lathe</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-load-obj.html">Loading .obj files</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-load-obj-w-mtl.html">Loading .obj w .mtl files</a></li>
        </ul>
  <li>Texturas</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-3d-textures.html">Textures</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-data-textures.html">Data Textures</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2-textures.html">Using 2 or More Textures</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-cors-permission.html">WebGL2 - Cross Origin Images</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-3d-perspective-correct-texturemapping.html">Perspective Correct Texture Mapping</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-planar-projection-mapping.html">Planar and Perspective Projection Mapping</a></li>
        </ul>
  <li>Renderizando Uma Textura</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-render-to-texture.html">Render to Texture</a></li>
        </ul>
  <li>Shadows</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-shadows.html">Shadows</a></li>
        </ul>
  <li>Técnicas</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2d-matrix-stack.html">2D - Matrix Stack</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-sprites.html">Sprites</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-cube-maps.html">Cubemaps</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-environment-maps.html">Environment maps</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-skybox.html">Skyboxes</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-skinning.html">Skinning</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-fog.html">Fog</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-picking.html">Picking (clicking on stuff)</a></li>
        </ul>
  <li>Text</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-text-html.html">WebGL2 Texto - HTML</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-text-canvas2d.html">WebGL2 Texto - Canvas 2D</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-text-texture.html">Text - Using a Texture</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-text-glyphs.html">Text - Using a Glyph Texture</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-smallest-programs.html">Smallest Programs</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-drawing-without-data.html">Drawing Without Data</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-indexed-vertices.html">Indexed Vertices (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-instanced-drawing.html">Instanced Drawing</a></li>
        </ul>
  <li>Diversos</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-setup-and-installation.html">WebGL2 Configuração e Instalação</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-boilerplate.html">Boilerplate</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-resizing-the-canvas.html">Resizing the Canvas</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-animation.html">WebGL2 - Animação</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-points-lines-triangles.html">Points, Lines, and Triangles</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-visualizing-the-camera.html">Visualizing the Camera</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-and-alpha.html">WebGL2 e o Alpha</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-2d-vs-3d-library.html">WebGL2 - Bibliotecas 2D vs 3D</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-anti-patterns.html">Anti-Patterns</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-matrix-vs-math.html">WebGL2 Matrices vs Math Matrices</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-precision-issues.html">Precision Issues</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-tips.html#html-background">Use WebGL2 as Background in HTML</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-cross-platform-issues.html">Cross Platform Issues</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-qna.html">Questions and Answers</a></li>
        </ul>
  <li>Reference</li>
        <ul>
          <li><a href="/webgl/lessons/pt-br/webgl-attributes.html">Attributes</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-texture-units.html">Texture Units</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-framebuffers.html">Framebuffers</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/pt-br/webgl-references.html">References</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">Documentação da API</a></li>
  <li><a href="https://twgljs.org">TWGL, Uma Pequena Biblioteca Auxiliar da WebGL</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">github</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        
<div>Problemas/Bug? <a href="https://github.com/gfxfundamentals/webgl2-fundamentals/issues">Pergunte no github</a>.</div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webgl2fundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL2 para a WebGL1';
            var disqus_title = 'WebGL2 para a WebGL1';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webgl2fundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "Thank you <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>for <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} contributions</a>",
  owner: "gfxfundamentals",
  repo: "webgl2-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
</script>


</html>




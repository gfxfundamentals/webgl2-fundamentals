<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/ko/webgl-environment-maps.md. Do not edited directly -->
<!--
Copyright 2021, GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="환경맵을 구현하는 방법.">
<meta name="keywords" content="webgl webgl2 graphics">
<meta name="thumbnail" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-environment-maps_ko.jpg">

<meta property="og:title" content="WebGL2 환경맵 (반사)">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-environment-maps_ko.jpg">
<meta property="og:description" content="환경맵을 구현하는 방법.">
<meta property="og:url" content="https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webgl2fundamentals.org">
<meta name="twitter:title" content="WebGL2 환경맵 (반사)">
<meta name="twitter:url" content="https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html">
<meta name="twitter:description" content="환경맵을 구현하는 방법.">
<meta name="twitter:image:src" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-environment-maps_ko.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webgl2fundamentals.org/#website",
      "url":"https://webgl2fundamentals.org/",
      "name":"Webgl2Fundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html#primaryimage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl-environment-maps_ko.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html#webpage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html",
      "inLanguage":"ko",
      "name":"WebGL2 환경맵 (반사)",
      "keywords":"webgl webgl2 graphics programming",
      "isPartOf":{
        "@id":"https://webgl2fundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webgl2fundamentals.org/webgl/lessons/ko/webgl-environment-maps.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL2 환경맵 (반사)</title>
<link href="/webgl/lessons/resources/webgl2fundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/ko/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl-environment-maps.html">
  <link rel="alternate" hreflang="de" href="https://webglfundamentals.org/webgl/lessons/de/webgl-environment-maps.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl-environment-maps.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl-environment-maps.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl-environment-maps.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl-environment-maps.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-environment-maps.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-environment-maps.html" >English</a>
    <option value="/webgl/lessons/de/webgl-environment-maps.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl-environment-maps.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-environment-maps.html" selected>한국어</a>
    <option value="/webgl/lessons/pt-br/webgl-environment-maps.html" >Português Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl-environment-maps.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-environment-maps.html" >简体中文</a>
</select>


    <a href="#toc">목차</a>
    <input type="search" placeholder="?" id="search">
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/ko/">WebGL2Fundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL2 환경맵 (반사)</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>이 글은 WebGL2 시리즈의 글입니다.
첫 글은 <a href="webgl-fundamentals.html">WebGL2 기초</a>입니다.
이 글은 <a href="webgl-cube-maps.html">큐브맵</a>에서 이어지는 글입니다.
이 글에서는 <a href="webgl-3d-lighting-directional.html">조명 효과</a>에서 다루었던 개념이 사용됩니다.
위 글들을 아직 읽지 않으셨으면 먼저 읽으시는 것이 좋습니다.</p>
<p><em>환경맵</em>이란 우리가 그리는 물체 주변의 환경을 표현합니다.
야외를 그리려고 한다면 야외 환경을 나타냅니다.
무대 위의 사람을 그리려고 한다면 그 공연장을 나타냅니다.
우주를 그리려고 한다면 별들이 될 겁니다.
환경을 표현하는 6장의 이미지가 있다면 큐브맵의 6방향을 사용해 환경맵을 구현할 수 있습니다.</p>
<p>아래는 캘리포니아 마운틴 뷰에 있는 컴퓨터 박물관의 로비 사진입니다.</p>
<div class="webgl_center">
  <img src="../../resources/images/computer-history-museum/pos-x.jpg" style="width: 128px" class="border">
  <img src="../../resources/images/computer-history-museum/neg-x.jpg" style="width: 128px" class="border">
  <img src="../../resources/images/computer-history-museum/pos-y.jpg" style="width: 128px" class="border">
</div>
<div class="webgl_center">
  <img src="../../resources/images/computer-history-museum/neg-y.jpg" style="width: 128px" class="border">
  <img src="../../resources/images/computer-history-museum/pos-z.jpg" style="width: 128px" class="border">
  <img src="../../resources/images/computer-history-museum/neg-z.jpg" style="width: 128px" class="border">
</div>
<p><a href="webgl-cube-maps.html">이전 글의 코드</a>를 기반으로 이미지를 생성하는 대신 6장의 이미지를 로드해 봅시다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 텍스처를 생성합니다.
var texture = gl.createTexture();
gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);

const faceInfos = [
  {
    target: gl.TEXTURE_CUBE_MAP_POSITIVE_X,
    url: 'resources/images/computer-history-museum/pos-x.jpg',
  },
  {
    target: gl.TEXTURE_CUBE_MAP_NEGATIVE_X,
    url: 'resources/images/computer-history-museum/neg-x.jpg',
  },
  {
    target: gl.TEXTURE_CUBE_MAP_POSITIVE_Y,
    url: 'resources/images/computer-history-museum/pos-y.jpg',
  },
  {
    target: gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,
    url: 'resources/images/computer-history-museum/neg-y.jpg',
  },
  {
    target: gl.TEXTURE_CUBE_MAP_POSITIVE_Z,
    url: 'resources/images/computer-history-museum/pos-z.jpg',
  },
  {
    target: gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,
    url: 'resources/images/computer-history-museum/neg-z.jpg',
  },
];
faceInfos.forEach((faceInfo) =&gt; {
  const {target, url} = faceInfo;

  // 캔버스를 큐브맵 면으로 업로드합니다.
  const level = 0;
  const internalFormat = gl.RGBA;
  const width = 512;
  const height = 512;
  const format = gl.RGBA;
  const type = gl.UNSIGNED_BYTE;

  // 바로 렌더링이 가능하도록 우선 각 면을 설정합니다.
  gl.texImage2D(target, level, internalFormat, width, height, 0, format, type, null);

  // 이미지를 비동기 로드합니다.
  const image = new Image();
  image.src = url;
  image.addEventListener('load', function() {
    // 이제 이미지가 로드되었으니 텍스처로 업로드합니다.
    gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);
    gl.texImage2D(target, level, internalFormat, format, type, image);
    gl.generateMipmap(gl.TEXTURE_CUBE_MAP);
  });
});
gl.generateMipmap(gl.TEXTURE_CUBE_MAP);
gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);
</code></pre>
<p>참고로 모든 면에 대해 512x512 크기로, <code class="notranslate" translate="no">texImage2D</code>에 <code class="notranslate" translate="no">null</code>을 전달하여 빈 이미지인 상태로 초기화 했습니다.
큐브맵은 6개 면 모두 있어야 하고, 모든 면의 크기가 정사각형이면서 같아야 합니다.
그렇지 않으면 렌더링되지 않습니다.
그런데 우리는 6장의 이미지를 로딩하고 있죠. 바로 렌더링을 시작할 수 있도록 6개 면 모드를 우선 할당하고나서 이미지 로딩을 시작합니다.
각 이미지가 로드되면 해당 면에 이미지를 업로드하고 밉맵을 다시 생성합니다.
즉 렌더링은 바로 시작되면서 이미지들이 다운로드 완료되면 큐브맵의 각 면이 하나씩 이미지로 바뀌게 됩니다. 이는 6개 모든 이미지가 다운로드 되지 않은 상태에서도 가능합니다.</p>
<p>하지만 그냥 이미지를 로딩하는 걸로는 부족합니다.
<a href="webgl-3d-lighting-point.html">조명 효과</a>에서처럼, 약간의 계산이 필요합니다.</p>
<p>이 예제에서는 각 프래그먼트에 대해 시점/카메라 위치로부터 물체 표면상의 한 position에 대한 벡터가 주어졌을 때, 반사되는 방향을 알아야 합니다.
그 방향을 기반으로 큐브맵으로부터 색상을 얻어와야 합니다.</p>
<p>반사에 대한 수식은 아래와 같습니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">reflectionDir = eyeToSurfaceDir –
    2 ∗ dot(surfaceNormal, eyeToSurfaceDir) ∗ surfaceNormal
</code></pre>
<p>위 수식이 맞다는 사실은 조금 생각해 보면 알 수 있습니다.
<a href="webgl-3d-lighting-directional.html">조명 효과</a> 글에서 두 벡터의 내적은 사이각의 코사인값이라는 것을 배웠습니다.
두 벡터를 더한 것은 벡터이므로 아래와 같이 평면을 수직으로 내려다보는 상황을 생각해 봅시다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-01.svg" style="width: 400px"></div>
<p>위 수식을 가시화해 봅시다. 먼저 두 벡터의 방향이 반대일 때 내적값은 -1이므로 이를 그려보면 아래와 같습니다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-02.svg" style="width: 400px"></div>
<p>이 내적값을 반사 수식에서 <span style="color:black; font-weight:bold;">eyeToSurfaceDir</span>
와 <span style="color:green;">normal</span>에 대해 적용해 보면 아래와 같이 됩니다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-03.svg" style="width: 400px"></div>
<p>-2와 -1을 곱했으므로 2가 됩니다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-04.svg" style="width: 400px"></div>
<p>따라서 이를 적용해 벡터를 더해보면 아래와 같은 <span style="color: red">반사 벡터</span>가 얻어집니다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-05.svg" style="width: 400px"></div>
<p>위 그림을 보면 2개의 법선으로부터, 시야에서 평면을 향하는 벡터는 더해서 0이 되고, 나머지 하나는 시야로 향하는 반사 벡터가 되는 것을 볼 수 있습니다.
다시 원래 다이어그램에 그려보면 우리가 원하는 결과인 것을 알 수 있습니다.</p>
<div class="webgl_center"><img src="../resources/reflect-180-06.svg" style="width: 400px"></div>
<p>이번엔 평면을 오른쪽으로 45도 기울여봅시다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-01.svg" style="width: 400px"></div>
<p>사이각이 135도인 벡터들의 내적은 -0.707입니다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-02.svg" style="width: 400px"></div>
<p>수식에 넣어보면 아래와 같이 됩니다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-03.svg" style="width: 400px"></div>
<p>음수 두 개를 더하면 양수가 되는데 이전과는 다르게 <span style="color: green">벡터</span>가 30% 정도 더 짧아졌습니다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-04.svg" style="width: 400px"></div>
<p>벡터들을 더하면 <span style="color: red">반사 벡터</span>가 됩니다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-05.svg" style="width: 400px"></div>
<p>다이어그램에 표시해 보면 올바른 결과라는 것을 볼 수 있습니다.</p>
<div class="webgl_center"><img src="../resources/reflect-45-06.svg" style="width: 400px"></div>
<p><span style="color: red">반사 방향</span>을 이용해 물체의 표면에 해당하는 큐브맵의 색상을 샘플링할 수 있습니다.</p>
<p>아래는 표면의 회전각을 바꾸어가면서 수식의 각 부분의 값을 볼 수 있는 다이어그램입니다.
또한 반사 벡터가 큐브맵의 어떤 면을 가리키는지와 그에 따른 색상 변화 효과를 볼 수 있습니다.</p>
<p><div class="webgl_diagram_container">
  <iframe class="webgl_example " style="width: 400px; height: 400px;" src="/webgl/lessons/resources/environment-mapping.html"></iframe>
</div>

</p>
<p>이제 반사가 어떻게 계산되는지 알았으니 이를 활용해 큐브맵으로부터 값을 샘플링하도록 셰이더를 수정할 수 있습니다.</p>
<p>먼저 정점 셰이더에서는 정점의 월드 좌표와 월드 공간에서의 법선 방향을 계산하여 varying으로 프래그먼트 셰이더에 넘겨줄 겁니다.
이는 <a href="webgl-3d-lighting-spot.html">스팟 조명 효과의 글</a>에서와 유사합니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">#version 300 es

in vec4 a_position;
in vec3 a_normal;

uniform mat4 u_projection;
uniform mat4 u_view;
uniform mat4 u_world;

out vec3 v_worldPosition;
out vec3 v_worldNormal;

void main() {
  // position에 행렬을 곱합니다.
  gl_Position = u_projection * u_view * u_world * a_position;

  // 시점 위치를 프래그먼트 셰이더로 넘겨줍니다.
  v_worldPosition = (u_world * a_position).xyz;

  // 법선 방향을 조정하여 프래그먼트 셰이더로 넘겨줍니다.
  v_worldNormal = mat3(u_world) * a_normal;
}
</code></pre>
<p>프래그먼트 셰이더에서는 <code class="notranslate" translate="no">worldNormal</code>이 보간되었으므로 정규화해줍니다.
카메라의 월드 좌표를 넘겨주었으므로 이를 표면의 월드 좌표에서 빼 주면 <code class="notranslate" translate="no">eyeToSurfaceDir</code>를 얻을 수 있습니다.</p>
<p>마지막으로 위에 설명한 수식이 구현되어있는 GLSL 내장 함수인 <code class="notranslate" translate="no">reflect</code>를 사용합니다.
반환값을 사용하여 큐브맵으로부터 색상값을 얻어옵니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-glsl">#version 300 es

precision highp float;

// 정점 셰이더에서 넘어온 값.
in vec3 v_worldPosition;
in vec3 v_worldNormal;

// 텍스처.
uniform samplerCube u_texture;

// 카메라의 위치
uniform vec3 u_worldCameraPosition;

// 프래그먼트 셰이더에서는 출력을 선언해야 합니다.
out vec4 outColor;

void main() {
  vec3 worldNormal = normalize(v_worldNormal);
  vec3 eyeToSurfaceDir = normalize(v_worldPosition - u_worldCameraPosition);
  vec3 direction = reflect(eyeToSurfaceDir,worldNormal);

  outColor = texture(u_texture, direction);
}
</code></pre>
<p>이 예제에서는 실제 법선도 필요합니다. 실제 법선을 활용해 육면체의 각 면이 평평하게 보이도록 할겁니다.
이전 예제에서는 큐브맵이 동작하는 것을 보기 위해 간단히 정점의 위치로 법선을 계산했지만 이번에는
<a href="webgl-3d-lighting-directional.html">조명 효과 관련 글</a>에서처럼 육면체의 실제 법선값이 필요합니다.</p>
<p>초기화 시점에,</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 법선을 입력하기 위한 버퍼를 생성합니다.
var normalBuffer = gl.createBuffer();
// ARRAY_BUFFER에 바인딩합니다. (ARRAY_BUFFER = normalBuffer인 상태로 생각하면 됩니다.)
gl.bindBuffer(gl.ARRAY_BUFFER, normalBuffer);
// 버퍼에 법선 데이터를 넣습니다.
setNormals(gl);

// normalBuffer (ARRAY_BUFFER)로부터 데이터를 읽어오는 방법을 attribute에 알려줍니다.
var size = 3;          // 각 iteration마다 3개의 값
var type = gl.FLOAT;   // 데이터는 32비트 부동소수점 값
var normalize = false; // 데이터를 정규화 하는지 여부 (0-255를 0-1로 변환하는지)
var stride = 0;        // 0인 경우 각 iteration마다 다음 값을 얻어오기 위해 size * sizeof(type)만큼 이동
var offset = 0;        // 버퍼의 맨 앞부터 시작
gl.vertexAttribPointer(
    normalLocation, size, type, normalize, stride, offset)
</code></pre>
<p>그리고 당연히 초기화 시점에 uniform의 location을 찾아야 합니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">var projectionLocation = gl.getUniformLocation(program, &quot;u_projection&quot;);
var viewLocation = gl.getUniformLocation(program, &quot;u_view&quot;);
var worldLocation = gl.getUniformLocation(program, &quot;u_world&quot;);
var textureLocation = gl.getUniformLocation(program, &quot;u_texture&quot;);
var worldCameraPositionLocation = gl.getUniformLocation(program, &quot;u_worldCameraPosition&quot;);
</code></pre>
<p>그리고 렌더링 시점에 값을 설정해 줍니다.</p>
<pre class="prettyprint notranslate" translate="no"><code class="lang-js">// 투영 행렬 계산
var aspect = gl.canvas.clientWidth / gl.canvas.clientHeight;
var projectionMatrix =
    m4.perspective(fieldOfViewRadians, aspect, 1, 2000);
gl.uniformMatrix4fv(projectionLocation, false, projectionMatrix);

var cameraPosition = [0, 0, 2];
var target = [0, 0, 0];
var up = [0, 1, 0];
// look at을 사용하여 카메라 행렬을 계산합니다.
var cameraMatrix = m4.lookAt(cameraPosition, target, up);

// 카메라 행렬로 뷰 행렬을 계산합니다.
var viewMatrix = m4.inverse(cameraMatrix);

var worldMatrix = m4.xRotation(modelXRotationRadians);
worldMatrix = m4.yRotate(worldMatrix, modelYRotationRadians);

// uniform들을 설정합니다.
gl.uniformMatrix4fv(projectionLocation, false, projectionMatrix);
gl.uniformMatrix4fv(viewLocation, false, viewMatrix);
gl.uniformMatrix4fv(worldLocation, false, worldMatrix);
gl.uniform3fv(worldCameraPositionLocation, cameraPosition);

// u_texture가 텍스처 유닛 0을 사용하도록 셰이더에게 알려줍니다.
gl.uniform1i(textureLocation, 0);
</code></pre>
<p>기본적인 반사 효과 결과는 아래와 같습니다.</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-environment-map.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-environment-map.html" target="_blank">새 창으로 열기</a>
</div>

</p>
<p>다음으로 <a href="webgl-skybox.html">큐브맵을 스카이박스로 사용하는 방법</a>에 대해 보여드리겠습니다.</p>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-environment-maps.html" >English</a>
    <option value="/webgl/lessons/de/webgl-environment-maps.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl-environment-maps.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl-environment-maps.html" selected>한국어</a>
    <option value="/webgl/lessons/pt-br/webgl-environment-maps.html" >Português Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl-environment-maps.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-environment-maps.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>기초</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-getting-webgl2.html">WebGL2 사용법</a></li>
<li><a href="/webgl/lessons/ko/webgl-fundamentals.html">기초</a></li>
<li><a href="/webgl/lessons/ko/webgl-how-it-works.html">WebGL2 작동 원리</a></li>
<li><a href="/webgl/lessons/ko/webgl-shaders-and-glsl.html">WebGL2 셰이더와 GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL2 State Diagram</a></li>
        </ul>
  <li>WebGL2 vs WebGL1</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl2-whats-new.html">WebGL2 새로운 기능</a></li>
<li><a href="/webgl/lessons/ko/webgl1-to-webgl2.html">WebGL1에서 WebGL2로의 변경</a></li>
<li><a href="/webgl/lessons/ko/webgl1-to-webgl2-fundamentals.html">WebGLFundamentals.org과 WebGL2Fundamentals.org의 차이점</a></li>
        </ul>
  <li>이미지 처리</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-image-processing.html">이미지 처리</a></li>
<li><a href="/webgl/lessons/ko/webgl-image-processing-continued.html">WebGL2 이미지 처리 심화</a></li>
        </ul>
  <li>2D 이동, 회전, 크기 변환 행렬 계산</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-translation.html">WebGL2 2D 이동</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-rotation.html">WebGL2 2D 회전</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-scale.html">WebGL2 2D 크기 변환</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrices.html">WebGL2 2D 행렬</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-orthographic.html">3D 직교 투영</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective.html">3D 원근 투영</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-camera.html">3D - 카메라</a></li>
<li><a href="/webgl/lessons/ko/webgl-matrix-naming.html">3D - 행렬의 이름</a></li>
        </ul>
  <li>Lighting</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-lighting-directional.html">방향성 조명 효과(Directional Lighting)</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-point.html">점 조명 효과(Point Lighting)</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-lighting-spot.html">스팟 조명 효과(Spot Lighting)</a></li>
        </ul>
  <li>Structure and Organization</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-less-code-more-fun.html">더 적은 코드로 즐겁게 코딩하기</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-multiple-things.html">여러 물체를 그리는 법</a></li>
<li><a href="/webgl/lessons/ko/webgl-scene-graph.html">장면(Scene) 그래프</a></li>
        </ul>
  <li>Geometry</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-geometry-lathe.html">3D Geometry - Lathe</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj.html">.obj 파일 로딩</a></li>
<li><a href="/webgl/lessons/ko/webgl-load-obj-w-mtl.html">Loading .obj w .mtl files</a></li>
        </ul>
  <li>Textures</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-3d-textures.html">텍스처</a></li>
<li><a href="/webgl/lessons/ko/webgl-data-textures.html">데이터 텍스처</a></li>
<li><a href="/webgl/lessons/ko/webgl-2-textures.html">두개 이상의 텍스처 사용하기</a></li>
<li><a href="/webgl/lessons/ko/webgl-cors-permission.html">교차 출처 이미지(Cross Origin Image)</a></li>
<li><a href="/webgl/lessons/ko/webgl-3d-perspective-correct-texturemapping.html">원근 교정 텍스처 매핑</a></li>
<li><a href="/webgl/lessons/ko/webgl-planar-projection-mapping.html">평면 및 원근 투영 매핑</a></li>
        </ul>
  <li>Rendering To A Texture</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-render-to-texture.html">텍스처에 렌더링하기</a></li>
        </ul>
  <li>Shadows</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-shadows.html">그림자</a></li>
        </ul>
  <li>Techniques</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-matrix-stack.html">2D - 행렬 스택</a></li>
<li><a href="/webgl/lessons/ko/webgl-sprites.html">Sprite</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-cube-maps.html">큐브맵</a></li>
<li><a href="/webgl/lessons/ko/webgl-environment-maps.html">환경맵</a></li>
<li><a href="/webgl/lessons/ko/webgl-skybox.html">Skybox</a></li>
<li><a href="/webgl/lessons/ko/webgl-skinning.html">Skinning</a></li>
<li><a href="/webgl/lessons/ko/webgl-fog.html">Fog</a></li>
<li><a href="/webgl/lessons/ko/webgl-picking.html">Picking (clicking on stuff)</a></li>
        </ul>
  <li>Text</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-text-html.html">텍스트 - HTML</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-canvas2d.html">텍스트 - Canvas 2D</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-texture.html">텍스트 - 텍스처 사용</a></li>
<li><a href="/webgl/lessons/ko/webgl-text-glyphs.html">Text - Using a Glyph Texture</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-smallest-programs.html">Smallest Programs</a></li>
<li><a href="/webgl/lessons/ko/webgl-drawing-without-data.html">Drawing Without Data</a></li>
<li><a href="/webgl/lessons/ko/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/ko/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-indexed-vertices.html">정점 인덱스 (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/ko/webgl-instanced-drawing.html">인스턴스 드로잉(Instanced Drawing)</a></li>
        </ul>
  <li>기타</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-setup-and-installation.html">설정 및 설치</a></li>
<li><a href="/webgl/lessons/ko/webgl-boilerplate.html">보일러플레이트(Boilerplate)</a></li>
<li><a href="/webgl/lessons/ko/webgl-resizing-the-canvas.html">Canvas 리사이징</a></li>
<li><a href="/webgl/lessons/ko/webgl-animation.html">애니메이션</a></li>
<li><a href="/webgl/lessons/ko/webgl-points-lines-triangles.html">점, 선, 삼각형</a></li>
<li><a href="/webgl/lessons/ko/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/ko/webgl-visualizing-the-camera.html">Visualizing the Camera</a></li>
<li><a href="/webgl/lessons/ko/webgl-and-alpha.html">WebGL2 알파(Alpha)</a></li>
<li><a href="/webgl/lessons/ko/webgl-2d-vs-3d-library.html">2D vs 3D 라이브러리</a></li>
<li><a href="/webgl/lessons/ko/webgl-anti-patterns.html">안티패턴</a></li>
<li><a href="/webgl/lessons/ko/webgl-matrix-vs-math.html">WebGL2 행렬 vs 수학에서의 행렬</a></li>
<li><a href="/webgl/lessons/ko/webgl-precision-issues.html">정밀도 이슈</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#screenshot">스크린샷 찍기</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#preservedrawingbuffer">Canvas Clear 방지</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#tabindex">캔버스에서 키보드 입력 받기</a></li>
<li><a href="/webgl/lessons/ko/webgl-tips.html#html-background">HTML에서 WebGL2를 배경으로 사용하기</a></li>
<li><a href="/webgl/lessons/ko/webgl-cross-platform-issues.html">Cross Platform 문제</a></li>
<li><a href="/webgl/lessons/ko/webgl-qna.html">질문 및 답변</a></li>
        </ul>
  <li>Reference</li>
        <ul>
          <li><a href="/webgl/lessons/ko/webgl-attributes.html">Attributes</a></li>
<li><a href="/webgl/lessons/ko/webgl-texture-units.html">텍스처 유닛</a></li>
<li><a href="/webgl/lessons/ko/webgl-framebuffers.html">Framebuffer</a></li>
<li><a href="/webgl/lessons/ko/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/ko/webgl-references.html">참고 자료</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">Helper API Docs</a></li>
  <li><a href="https://twgljs.org">TWGL, A tiny WebGL helper library</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">github</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        
    <div>이슈나 버그가 있나요? <a href="https://github.com/greggman/webgl2-fundamentals/issues">깃헙에서 이슈 만들기</a>.</div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webgl2fundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL2 환경맵 (반사)';
            var disqus_title = 'WebGL2 환경맵 (반사)';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webgl2fundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "<a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a>님, <br>당신의 <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} 기여</a>에 감사드립니다.",
  owner: "gfxfundamentals",
  repo: "webgl2-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
</script>


</html>




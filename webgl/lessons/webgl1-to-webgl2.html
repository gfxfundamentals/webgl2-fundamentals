<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/webgl1-to-webgl2.md. Do not edited directly -->
<!--
Copyright 2021, GFXFundamentals.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of GFXFundamentals. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="How to move from WebGL1 to WebGL2">
<meta name="keywords" content="webgl webgl2 graphics">
<meta name="thumbnail" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_en.jpg">

<meta property="og:title" content="WebGL2 from WebGL1">
<meta property="og:type" content="website">
<meta property="og:image" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_en.jpg">
<meta property="og:description" content="How to move from WebGL1 to WebGL2">
<meta property="og:url" content="https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@greggman">
<meta name="twitter:creator" content="@greggman">
<meta name="twitter:domain" content="webgl2fundamentals.org">
<meta name="twitter:title" content="WebGL2 from WebGL1">
<meta name="twitter:url" content="https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html">
<meta name="twitter:description" content="How to move from WebGL1 to WebGL2">
<meta name="twitter:image:src" content="https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_en.jpg">

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://webgl2fundamentals.org/#website",
      "url":"https://webgl2fundamentals.org/",
      "name":"Webgl2Fundamentals"
    },
    {
      "@type":"ImageObject",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html#primaryimage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/screenshots/webgl1-to-webgl2_en.jpg",
      "width":1200,
      "height":630
    },
    {
      "@type":"WebPage",
      "@id":"https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html#webpage",
      "url":"https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html",
      "inLanguage":"en",
      "name":"WebGL2 from WebGL1",
      "keywords":"webgl webgl2 graphics programming",
      "isPartOf":{
        "@id":"https://webgl2fundamentals.org/#website"
      },
      "primaryImageOfPage":{
        "@id":"https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html#primaryimage"
      }
    }
  ]
}
</script>


<title>WebGL2 from WebGL1</title>
<link href="/webgl/lessons/resources/webgl2fundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/lang.css">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css">

  <link rel="alternate" hreflang="en" href="https://webglfundamentals.org/webgl/lessons/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="de" href="https://webglfundamentals.org/webgl/lessons/de/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="ja" href="https://webglfundamentals.org/webgl/lessons/ja/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="ko" href="https://webglfundamentals.org/webgl/lessons/ko/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="pt-br" href="https://webglfundamentals.org/webgl/lessons/pt-br/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="ru" href="https://webglfundamentals.org/webgl/lessons/ru/webgl1-to-webgl2.html">
  <link rel="alternate" hreflang="zh_cn" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl1-to-webgl2.html">




</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl1-to-webgl2.html" selected>English</a>
    <option value="/webgl/lessons/de/webgl1-to-webgl2.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl1-to-webgl2.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl1-to-webgl2.html" >한국어</a>
    <option value="/webgl/lessons/pt-br/webgl1-to-webgl2.html" >Português Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl1-to-webgl2.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl1-to-webgl2.html" >简体中文</a>
</select>


    <a href="#toc">Table of Contents</a>
    <input type="search" placeholder="?" id="search">
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/">WebGL2Fundamentals.org</a></h1>
<style>
#forkongithub>div {
    background: #000;
    color: #fff;
    font-family: arial,sans-serif;
    text-align: center;
    font-weight: bold;
    padding: 5px 40px;
    font-size: 0.9rem;
    line-height: 1.3rem;
    position: relative;
    transition: 0.5s;
    display: block;
    width: 400px;
    position: absolute;
    top: 0;
    right: 0;
    transform: translateX(200px) rotate(45deg) translate(10px,70px);
    box-shadow: 4px 4px 10px rgba(0,0,0,0.8);
    pointer-events: auto;
}
#forkongithub a {
  text-decoration: none;
  color: #fff;
}
#forkongithub>div:hover {
    background: #c11;
    color: #fff;
}
#forkongithub .contributors {
  font-size: 0.75rem;
  background: rgba(255,255,255,0.2);
  line-height: 1.2;
  padding: 0.1em;
}
#forkongithub>div::before,#forkongithub>div::after {
    content: "";
    width: 100%;
    display: block;
    position: absolute;
    top: 1px;
    left: 0;
    height: 1px;
    background: #fff;
}
#forkongithub>div::after {
    bottom: 1px;
    top: auto;
}

#forkongithub{
    z-index: 9999;
    /* needed for firefox */
    overflow: hidden;
    width: 300px;
    height: 300px;
    position: absolute;
    right: 0;
    top: 0;
    pointer-events: none;
}
#forkongithub svg{
  width: 1em;
  height: 1em;
  vertical-align: middle;
}
#forkongithub img {
  width: 1em;
  height: 1em;
  border-radius: 100%;
  vertical-align: middle;
}

@media (max-width: 900px) {
    #forkongithub>div {
        line-height: 1.2rem;
    }
}
@media (max-width: 700px) {
  #forkongithub {
    display: none;
  }
}
@media (max-width: 410px) {
    #forkongithub>div {
        font-size: 0.7rem;
        transform: translateX(150px) rotate(45deg) translate(20px,40px);
    }
}

</style>
<div id="forkongithub"><div><div><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">Fix, Fork, Contribute <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 136 133" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(3.92891,0,0,3.92891,67.867,129.125)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.779 -11.354,-8.28 -11.354,-8.28C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.155 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.238C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.84 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.84 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904" style="fill:white;"/>
    </g>
</svg>
</a></div></div></div>

</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL2 from WebGL1</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>WebGL2 is <strong>nearly</strong> 100% backward compatible with WebGL1.
If you only use WebGL1 features then then there are
only 2 <strong>major</strong> differences.</p>
<ol>
<li>
<p>You use <code class="notranslate" translate="no">&quot;webgl2&quot;</code> instead of <code class="notranslate" translate="no">&quot;webgl&quot;</code> when calling <code class="notranslate" translate="no">getContext</code>.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var gl = someCanvas.getContext(&quot;webgl2&quot;);
</code></pre>
<p>Note: there is no “experimental-webgl2”. The browser vendors got
together and decided not to continue prefixing things because websites
get dependent on the prefix.</p>
</li>
<li>
<p>Many extensions are a standard part of WebGL2 and so not available
as extensions.</p>
<p>For example Vertex Array Objects <code class="notranslate" translate="no">OES_vertex_array_object</code> is a
standard feature of WebGL2. So for example in WebGL1 you’d do this</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var ext = gl.getExtension(&quot;OES_vertex_array_object&quot;);
if (!ext) {
  // tell user they don't have the required extension or work around it
} else {
  var someVAO = ext.createVertexArrayOES();
}
</code></pre>
<p>In WebGL2 you’d do this</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var someVAO = gl.createVertexArray();
</code></pre>
<p>Because it just exists.</p>
</li>
</ol>
<p>That being said, to take advantage of most WebGL2 features you’ll need to make
some changes.</p>
<h2 id="switch-to-glsl-300-es">Switch to GLSL 300 es</h2>
<p>The biggest change is you should upgrade your shaders to GLSL 3.00 ES. To do
that the first line of your shaders needs to be</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">#version 300 es
</code></pre>
<p><strong>NOTE: THIS HAS TO BE THE FIRST LINE! No comments and no blank lines before it are allowed.</strong></p>
<p>In other words, this is bad</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// BAD!!!!                +---There's a new line here!
// BAD!!!!                V
var vertexShaderSource = `
#version 300 es
..
`;
</code></pre>
<p>This is bad, too</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;!-- BAD!!                   V&lt;- there's a new line here
&lt;script id=&quot;vs&quot; type=&quot;notjs&quot;&gt;
#version 300 es
...
&lt;/script&gt;
</code></pre>
<p>This is good</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var vertexShaderSource = `#version 300 es
...
`;
</code></pre>
<p>This is good, too</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">&lt;script id=&quot;vs&quot; type=&quot;notjs&quot;&gt;#version 300 es
...
&lt;/script&gt;
</code></pre>
<p>Or you could make your shader compiling functions strip
the first blank lines.</p>
<h3 id="changes-in-glsl-300-es-from-glsl-100">Changes in GLSL 300 es from GLSL 100</h3>
<p>There are several changes you’ll need to make to your shaders
on top of adding the version string above.</p>
<h4 id="attribute---in"><code class="notranslate" translate="no">attribute</code> -&gt; <code class="notranslate" translate="no">in</code></h4>
<p>In GLSL 100 you might have</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">attribute vec4 a_position;
attribute vec2 a_texcoord;
attribute vec3 a_normal;
</code></pre>
<p>In GLSL 300 es that becomes</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">in vec4 a_position;
in vec2 a_texcoord;
in vec3 a_normal;
</code></pre>
<h4 id="varying-to-in--out"><code class="notranslate" translate="no">varying</code> to <code class="notranslate" translate="no">in</code> / <code class="notranslate" translate="no">out</code></h4>
<p>In GLSL 100 you might declare a varying in both the vertex
and fragment shaders like this</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">varying vec2 v_texcoord;
varying vec3 v_normal;
</code></pre>
<p>In GLSL 300 es in the vertex shader the varyings become</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">out vec2 v_texcoord;
out vec3 v_normal;
</code></pre>
<p>And in the fragment shader they become</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">in vec2 v_texcoord;
in vec3 v_normal;
</code></pre>
<h4 id="no-more-gl_fragcolor">No more <code class="notranslate" translate="no">gl_FragColor</code></h4>
<p>In GLSL 100 your fragment shader would set the special
variable <code class="notranslate" translate="no">gl_FragColor</code> to set the output of the shader.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl_FragColor = vec4(1, 0, 0, 1);  // red
</code></pre>
<p>In GLSL 300 es you declare your own output variable and
then set it.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">out vec4 myOutputColor;

void main() {
   myOutputColor = vec4(1, 0, 0, 1);  // red
}
</code></pre>
<p>Note: You can pick any name you want but names can <strong>not</strong> start with
<code class="notranslate" translate="no">gl_</code> so you can’t just make <code class="notranslate" translate="no">out vec4 gl_FragColor</code>.</p>
<h4 id="texture2d---texture-etc"><code class="notranslate" translate="no">texture2D</code> -&gt; <code class="notranslate" translate="no">texture</code> etc.</h4>
<p>In GLSL 100 you’d get a color from a texture like this</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">uniform sampler2D u_some2DTexture;
uniform samplerCube u_someCubeTexture;

...

vec4 color1 = texture2D(u_some2DTexture, ...);
vec4 color2 = textureCube(u_someCubeTexture, ...);
</code></pre>
<p>In GLSL 300 es the texture functions automatically know
what to do based on the sampler type. So now, it’s just
<code class="notranslate" translate="no">texture</code></p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">uniform sampler2D u_some2DTexture;
uniform samplerCube u_someCubeTexture;

...

vec4 color1 = texture(u_some2DTexture, ...);
vec4 color2 = texture(u_someCubeTexture, ...);
</code></pre>
<h2 id="features-you-can-take-for-granted">Features you can take for granted</h2>
<p>In WebGL1 many features were optional extensions. In WebGL2
all of the following are standard features:</p>
<ul>
<li>Depth Textures (<a href="https://www.khronos.org/registry/webgl/extensions/WEBGL_depth_texture/">WEBGL_depth_texture</a>)</li>
<li>Floating Point Textures (<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_float/">OES_texture_float</a>/<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_float_linear/">OES_texture_float_linear</a>)</li>
<li>Half Floating Point Textures (<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_half_float/">OES_texture_half_float</a>/<a href="https://www.khronos.org/registry/webgl/extensions/OES_texture_half_float_linear/">OES_texture_half_float_linear</a>)</li>
<li>Vertex Array Objects (<a href="https://www.khronos.org/registry/webgl/extensions/OES_vertex_array_object/">OES_vertex_array_object</a>)</li>
<li>Standard Derivatives (<a href="https://www.khronos.org/registry/webgl/extensions/OES_standard_derivatives/">OES_standard_derivatives</a>)</li>
<li>Instanced Drawing (<a href="https://www.khronos.org/registry/webgl/extensions/ANGLE_instanced_arrays/">ANGLE_instanced_arrays</a>)</li>
<li>UNSIGNED_INT indices (<a href="https://www.khronos.org/registry/webgl/extensions/OES_element_index_uint/">OES_element_index_uint</a>)</li>
<li>Setting <code class="notranslate" translate="no">gl_FragDepth</code> (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_frag_depth/">EXT_frag_depth</a>)</li>
<li>Blend Equation MIN/MAX (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_blend_minmax/">EXT_blend_minmax</a>)</li>
<li>Direct texture LOD access (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_shader_texture_lod/">EXT_shader_texture_lod</a>)</li>
<li>Multiple Draw Buffers (<a href="https://www.khronos.org/registry/webgl/extensions/WEBGL_draw_buffers/">WEBGL_draw_buffers</a>)</li>
<li>sRGB support to textures and framebuffer objects (<a href="https://www.khronos.org/registry/webgl/extensions/EXT_sRGB/">EXT_sRGB</a>)</li>
<li>Any level of a texture can be attached to a framebuffer object (<a href="https://www.khronos.org/registry/webgl/extensions/OES_fbo_render_mipmap/">OES_fbo_render_mipmap</a>)</li>
<li>Texture access in vertex shaders</li>
</ul>
<h2 id="non-power-of-2-texture-support">Non-Power of 2 Texture Support</h2>
<p>in WebGL1 textures that were not a power of 2 could not have mips.
In WebGL2 that limit is removed. Non-power of 2 textures work exactly
the same as power of 2 textures.</p>
<h2 id="floating-point-framebuffer-attachments">Floating Point Framebuffer Attachments</h2>
<p>In WebGL1 to check for support for rendering to a floating point texture
you would first check for and enable the <code class="notranslate" translate="no">OES_texture_float</code> extension, then
you’d create a floating point texture, attach it to a framebuffer, and call
<code class="notranslate" translate="no">gl.checkFramebufferStatus</code> to see if it returned <code class="notranslate" translate="no">gl.FRAMEBUFFER_COMPLETE</code>.</p>
<p>In WebGL2 you need to check for and enable <code class="notranslate" translate="no">EXT_color_buffer_float</code> or else
<code class="notranslate" translate="no">gl.checkFramebufferStatus</code> will never return <code class="notranslate" translate="no">gl.FRAMEBUFFER_COMPLETE</code> for
a floating point texture.</p>
<p>Note that this is also true for <code class="notranslate" translate="no">HALF_FLOAT</code> framebuffer attachments as well.</p>
<blockquote>
<p>If you’re curious, this was a <em>bug</em> in the WebGL1 spec. What happened is that WebGL1
shipped and <code class="notranslate" translate="no">OES_texture_float</code> was added, and it was just assumed the correct
way to use it for rendering was to create a texture, attach it to a framebuffer,
and check its status. Later someone pointed out that according to the spec that was
not enough because the spec says colors written in a fragment shader are
always clamped to 0 to 1. <code class="notranslate" translate="no">EXT_color_buffer_float</code> removes that clamping
restriction, but since WebGL had already been shipping for a year or so
it would have broken many web sites to enforce the restriction. For WebGL2
they were able to fix it and so now you must enable <code class="notranslate" translate="no">EXT_color_buffer_float</code>
to use floating point textures as framebuffer attachments.</p>
<p>NOTE that AFAIK, as of March 2017 very few mobile devices support rendering to
floating point textures.</p>
</blockquote>
<h2 id="vertex-array-objects">Vertex Array Objects</h2>
<p>Of all the features above the one feature I personally think you should
always ALWAYS use is vertex array objects. Everything else really
depends on what you’re trying to do but vertex array objects in particular
seem like a basic feature that should always be used.</p>
<p>In WebGL1 without vertex array objects all the data about attributes
was global WebGL state. You can imagine it like this</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var glState = {
  attributeState: {
    ELEMENT_ARRAY_BUFFER: null,
    attributes: [
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
      { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },
    ],
  },
}
</code></pre>
<p>Calling functions like <code class="notranslate" translate="no">gl.vertexAttribPointer</code>, <code class="notranslate" translate="no">gl.enableVertexAttribArray</code>, and
<code class="notranslate" translate="no">gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ??)</code> would affect that global state.
Before each thing you wanted to draw you needed to setup all the attributes, and if you
were drawing indexed data you needed to set the <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code>.</p>
<p>With Vertex Array Objects that entire <code class="notranslate" translate="no">attributeState</code> above becomes a <em>Vertex Array</em>.</p>
<p>In other words</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">var someVAO = gl.createVertexArray();
</code></pre>
<p>Makes a new instance of the thing above called <code class="notranslate" translate="no">attributeState</code>.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(someVAO);
</code></pre>
<p>This is equivalent to</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">glState.attributeState = someVAO;
</code></pre>
<p>What that means is that you should setup all of your attributes at init time now.</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">// at init time
for each model / geometry / ...
  var vao = gl.createVertexArray()
  gl.bindVertexArray(vao);
  for each attribute
    gl.enableVertexAttribArray(...);
    gl.bindBuffer(gl.ARRAY_BUFFER, bufferForAttribute);
    gl.vertexAttribPointer(...);
  if indexed geometry
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
  gl.bindVertexArray(null);
</code></pre>
<p>Then at render time to use a particular geometry all you need to do
is</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(vaoForGeometry);
</code></pre>
<p>In WebGL1 the init loop above would have appeared at render time.
This is a HUGE speed up!</p>
<p>There are a few caveats though:</p>
<ol>
<li>
<p>attribute locations are program dependent.</p>
<p>If you’re going to use the same geometry with multiple
programs, consider manually assigning attribute locations.
In GLSL 300 es you can do this in the shader.</p>
<p>For example:</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">layout(location = 0) in vec4 a_position;
layout(location = 1) in vec2 a_texcoord;
layout(location = 2) in vec3 a_normal;
layout(location = 3) in vec4 a_color;
</code></pre>
<p>Sets the locations of the 4 attributes.</p>
<p>You can also still do it the WebGL1 way by calling
<code class="notranslate" translate="no">gl.bindAttribLocation</code> before calling <code class="notranslate" translate="no">gl.linkProgram</code>.</p>
<p>For example:</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindAttribLocation(someProgram, 0, &quot;a_position&quot;);
gl.bindAttribLocation(someProgram, 1, &quot;a_texcoord&quot;);
gl.bindAttribLocation(someProgram, 2, &quot;a_normal&quot;);
gl.bindAttribLocation(someProgram, 3, &quot;a_color&quot;);
</code></pre>
<p>This means you can force them to be compatible across multiple shader
programs. If one program doesn’t need all attributes,
the attributes they do need will still be assigned to
the same locations.</p>
<p>If you don’t do this you’ll need different VAOs for
different shader programs when using the same geometry OR
you’ll need to just do the WebGL1 thing and not use
VAOs and always setup attributes at render time, which is slow.</p>
<p>NOTE: of the 2 methods above I’m leaning toward using
<code class="notranslate" translate="no">gl.bindAttribLocation</code> because it’s easy to have it in one
place in my code whereas the method of using <code class="notranslate" translate="no">layout(location = ?)</code> has
to be in all shaders, so in the interest of D.R.Y., <code class="notranslate" translate="no">gl.bindAttribLocation</code>
seems better. Maybe if I was using a shader generator then there’d be no difference.</p>
</li>
<li>
<p>Always unbind the VAO when you’re done</p>
<pre class="prettyprint notranslate" translate="no"><code class="notranslate" translate="no">gl.bindVertexArray(null);
</code></pre>
<p>This just comes from my own experience. If you look above,
the <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code> state is part of a Vertex Array.</p>
<p>So, I ran into this issue. I created some geometry, then
I created a VAO for that geometry and set up the attributes
and <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code>. I then created some more
geometry. When that geometry setup its indices, because
I still had the previous VAO bound setting up, the indices
effected the <code class="notranslate" translate="no">ELEMENT_ARRAY_BUFFER</code> binding for the previous
VAO. It took me several hours to debug.</p>
<p>So, my suggestion is to never leave a VAO bound if you’re done
with it. Either immediately bind the next VAO you’re going
to use, or bind <code class="notranslate" translate="no">null</code> if you’re done.</p>
</li>
</ol>
<p>As mentioned at the top, many extensions from WebGL1 are standard features
of WebGL2, so if you were using extensions in WebGL1, you’ll need to
change your code to not use them as extensions in WebGL2. See below.</p>
<p>Two that need special care though:</p>
<ol>
<li>
<p><code class="notranslate" translate="no">OES_texture_float</code> and floating point textures.</p>
<p>Floating point textures are a standard feature of WebGL2 but:</p>
<ul>
<li>
<p>Being able to filter floating point textures is still an extension: <code class="notranslate" translate="no">OES_texture_float_linear</code>.</p>
</li>
<li>
<p>Being able to render to a floating point texture is an extension: <code class="notranslate" translate="no">EXT_color_buffer_float</code>.</p>
</li>
<li>
<p>Creating a floating point texture is different. You must use one of the new WebGL2 internal
formats like <code class="notranslate" translate="no">RGBA32F</code>, <code class="notranslate" translate="no">R32F</code>, etc. This is different than the WebGL1 <code class="notranslate" translate="no">OES_texture_float</code>
extension in which the internal format was inferred from the <code class="notranslate" translate="no">type</code> passed to <code class="notranslate" translate="no">texImage2D</code>.</p>
</li>
</ul>
</li>
<li>
<p><code class="notranslate" translate="no">WEBGL_depth_texture</code> and depth textures.</p>
<p>Similar to the previous difference, to create a depth texture in WebGL2 you must use one of
WebGL2’s internal formats: <code class="notranslate" translate="no">DEPTH_COMPONENT16</code>, <code class="notranslate" translate="no">DEPTH_COMPONENT24</code>,
<code class="notranslate" translate="no">DEPTH_COMPONENT32F</code>, <code class="notranslate" translate="no">DEPTH24_STENCIL8</code>, or <code class="notranslate" translate="no">DEPTH32F_STENCIL8</code>, whereas the WebGL1
<code class="notranslate" translate="no">WEBGL_depth_texture</code> extension used <code class="notranslate" translate="no">DEPTH_COMPONENT</code> and <code class="notranslate" translate="no">DEPTH_STENCIL_COMPONENT</code>.</p>
</li>
</ol>
<p>That’s my personal short list of things to be aware of when switching
from WebGL1 to WebGL2. <a href="webgl2-whats-new.html">There’s even more stuff you can do in WebGL2, though</a>.</p>
<div class="webgl_bottombar">
<h3>Making WebGL1 extensions look like WebGL2</h3>
<p>Functions that were on extensions in WebGL1 are now on the main
context in WebGL2. For example in WebGL</p>
<pre class="prettyprint">
var ext = gl.getExtension("OES_vertex_array_object");
if (!ext) {
  // tell user they don't have the required extension or work around it
} else {
  var someVAO = ext.createVertexArrayOES();
}
</pre>
<p>
vs in webgl2
</p>
<pre class="prettyprint">
var someVAO = gl.createVertexArray();
</pre>
<p>As you can see, if you want your code to run in both WebGL1 and WebGL2, then
that can present some challenges.</p>
<p>One workaround would be to copy WebGL1 extensions to the WebGL context at init time.
That way the rest of your code can stay the same. Example:</p>
<pre class="prettyprint">
const gl &#x3D; someCanvas.getContext(&quot;webgl&quot;);
const haveVAOs &#x3D; getAndApplyExtension(gl, &quot;OES_vertex_array_object&quot;);

function getAndApplyExtension(gl, name) {
  const ext &#x3D; gl.getExtension(name);
  if (!ext) {
    return null;
  }
  const fnSuffix &#x3D; name.split(&quot;_&quot;)[0];
  const enumSuffix &#x3D; &#x27;_&#x27; + fnSuffix;
  for (const key in ext) {
    const value &#x3D; ext[key];
    const isFunc &#x3D; typeof (value) &#x3D;&#x3D;&#x3D; &#x27;function&#x27;;
    const suffix &#x3D; isFunc ? fnSuffix : enumSuffix;
    let name &#x3D; key;
    // examples of where this is not true are WEBGL_compressed_texture_s3tc
    // and WEBGL_compressed_texture_pvrtc
    if (key.endsWith(suffix)) {
      name &#x3D; key.substring(0, key.length - suffix.length);
    }
    if (gl[name] !&#x3D;&#x3D; undefined) {
      if (!isFunc &amp;&amp; gl[name] !&#x3D;&#x3D; value) {
        console.warn(&quot;conflict:&quot;, name, gl[name], value, key);
      }
    } else {
      if (isFunc) {
        gl[name] &#x3D; function(origFn) {
          return function() {
            return origFn.apply(ext, arguments);
          };
        }(value);
      } else {
        gl[name] &#x3D; value;
      }
    }
  }
  return ext;
}
</pre>
<p>Now your code can mostly just work the same on both. Example:</p>
<pre class="prettyprint">
if (haveVAOs) {
  var someVAO &#x3D; gl.createVertexArray();
  ...
} else {
  ... do whatever for no VAOs.
}
</pre>
<p>The alternative would be having to do something like this</p>
<pre class="prettyprint">
if (haveVAOs) {
  if (isWebGL2)
     someVAO &#x3D; gl.createVertexArray();
  } else {
     someVAO &#x3D; vaoExt.createVertexArrayOES();
  }
  ...
} else {
  ... do whatever for no VAOs.
}
</pre>
<p>Note: In the case of Vertex Array Objects in particular I suggest you <a href="https://github.com/greggman/oes-vertex-array-object-polyfill">use a polyfill</a>
so you'll have them everywhere. VAOs are available on most systems. On those few systems
where they aren't available, the polyfill will handle it for you, and your code
can stay simple.</p>
</div>

    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl1-to-webgl2.html" selected>English</a>
    <option value="/webgl/lessons/de/webgl1-to-webgl2.html" >Deutsch</a>
    <option value="/webgl/lessons/ja/webgl1-to-webgl2.html" >日本語</a>
    <option value="/webgl/lessons/ko/webgl1-to-webgl2.html" >한국어</a>
    <option value="/webgl/lessons/pt-br/webgl1-to-webgl2.html" >Português Brasileiro</a>
    <option value="/webgl/lessons/ru/webgl1-to-webgl2.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl1-to-webgl2.html" >简体中文</a>
</select>


        <div id="toc">
          <ul>  <li>Fundamentals</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-getting-webgl2.html">How to use WebGL2</a></li>
<li><a href="/webgl/lessons/webgl-fundamentals.html">Fundamentals</a></li>
<li><a href="/webgl/lessons/webgl-how-it-works.html">How It Works</a></li>
<li><a href="/webgl/lessons/webgl-shaders-and-glsl.html">Shaders and GLSL</a></li>
<li><a href="/webgl/lessons/resources/webgl-state-diagram.html">WebGL2 State Diagram</a></li>
        </ul>
  <li>WebGL2 vs WebGL1</li>
        <ul>
          <li><a href="/webgl/lessons/webgl2-whats-new.html">What's new in WebGL2</a></li>
<li><a href="/webgl/lessons/webgl1-to-webgl2.html">Moving from WebGL1 to WebGL2</a></li>
<li><a href="/webgl/lessons/webgl1-to-webgl2-fundamentals.html">Differences from WebGLFundamentals.org to WebGL2Fundamentals.org</a></li>
        </ul>
  <li>Image Processing</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-image-processing.html">Image Processing</a></li>
<li><a href="/webgl/lessons/webgl-image-processing-continued.html">Image Processing Continued</a></li>
        </ul>
  <li>2D translation, rotation, scale, matrix math</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-2d-translation.html">2D Translation</a></li>
<li><a href="/webgl/lessons/webgl-2d-rotation.html">2D Rotation</a></li>
<li><a href="/webgl/lessons/webgl-2d-scale.html">2D Scale</a></li>
<li><a href="/webgl/lessons/webgl-2d-matrices.html">2D Matrices</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-3d-orthographic.html">Orthographic 3D</a></li>
<li><a href="/webgl/lessons/webgl-3d-perspective.html">3D Perspective</a></li>
<li><a href="/webgl/lessons/webgl-3d-camera.html">3D - Cameras</a></li>
<li><a href="/webgl/lessons/webgl-matrix-naming.html">3D - Matrix Naming</a></li>
        </ul>
  <li>Lighting</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-3d-lighting-directional.html">Directional Lighting</a></li>
<li><a href="/webgl/lessons/webgl-3d-lighting-point.html">Point Lighting</a></li>
<li><a href="/webgl/lessons/webgl-3d-lighting-spot.html">Spot Lighting</a></li>
        </ul>
  <li>Structure and Organization</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-less-code-more-fun.html">Less Code, More Fun</a></li>
<li><a href="/webgl/lessons/webgl-drawing-multiple-things.html">Drawing Multiple Things</a></li>
<li><a href="/webgl/lessons/webgl-scene-graph.html">Scene Graphs</a></li>
        </ul>
  <li>Geometry</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-3d-geometry-lathe.html">3D Geometry - Lathe</a></li>
<li><a href="/webgl/lessons/webgl-load-obj.html">Loading .obj files</a></li>
<li><a href="/webgl/lessons/webgl-load-obj-w-mtl.html">Loading .obj w .mtl files</a></li>
        </ul>
  <li>Textures</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-3d-textures.html">Textures</a></li>
<li><a href="/webgl/lessons/webgl-data-textures.html">Data Textures</a></li>
<li><a href="/webgl/lessons/webgl-2-textures.html">Using 2 or More Textures</a></li>
<li><a href="/webgl/lessons/webgl-cors-permission.html">Cross Origin Images</a></li>
<li><a href="/webgl/lessons/webgl-3d-perspective-correct-texturemapping.html">Perspective Correct Texture Mapping</a></li>
<li><a href="/webgl/lessons/webgl-planar-projection-mapping.html">Planar and Perspective Projection Mapping</a></li>
        </ul>
  <li>Rendering To A Texture</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-render-to-texture.html">Render to Texture</a></li>
        </ul>
  <li>Shadows</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-shadows.html">Shadows</a></li>
        </ul>
  <li>Techniques</li>
        <ul>
            <li>2D</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-2d-drawimage.html">2D - DrawImage</a></li>
<li><a href="/webgl/lessons/webgl-2d-matrix-stack.html">2D - Matrix Stack</a></li>
<li><a href="/webgl/lessons/webgl-sprites.html">Sprites</a></li>
        </ul>
  <li>3D</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-cube-maps.html">Cubemaps</a></li>
<li><a href="/webgl/lessons/webgl-environment-maps.html">Environment maps</a></li>
<li><a href="/webgl/lessons/webgl-skybox.html">Skyboxes</a></li>
<li><a href="/webgl/lessons/webgl-skinning.html">Skinning</a></li>
<li><a href="/webgl/lessons/webgl-fog.html">Fog</a></li>
<li><a href="/webgl/lessons/webgl-picking.html">Picking (clicking on stuff)</a></li>
        </ul>
  <li>Text</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-text-html.html">Text - HTML</a></li>
<li><a href="/webgl/lessons/webgl-text-canvas2d.html">Text - Canvas 2D</a></li>
<li><a href="/webgl/lessons/webgl-text-texture.html">Text - Using a Texture</a></li>
<li><a href="/webgl/lessons/webgl-text-glyphs.html">Text - Using a Glyph Texture</a></li>
        </ul>
  <li>GPGPU</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-gpgpu.html">GPGPU</a></li>
        </ul>
        </ul>
  <li>Tips</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-smallest-programs.html">Smallest Programs</a></li>
<li><a href="/webgl/lessons/webgl-drawing-without-data.html">Drawing Without Data</a></li>
<li><a href="/webgl/lessons/webgl-shadertoy.html">Shadertoy</a></li>
<li><a href="/webgl/lessons/webgl-pulling-vertices.html">Pulling Vertices</a></li>
        </ul>
  <li>Optimization</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-indexed-vertices.html">Indexed Vertices (gl.drawElements)</a></li>
<li><a href="/webgl/lessons/webgl-instanced-drawing.html">Instanced Drawing</a></li>
        </ul>
  <li>Misc</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-setup-and-installation.html">Setup And Installation</a></li>
<li><a href="/webgl/lessons/webgl-boilerplate.html">Boilerplate</a></li>
<li><a href="/webgl/lessons/webgl-resizing-the-canvas.html">Resizing the Canvas</a></li>
<li><a href="/webgl/lessons/webgl-animation.html">Animation</a></li>
<li><a href="/webgl/lessons/webgl-points-lines-triangles.html">Points, Lines, and Triangles</a></li>
<li><a href="/webgl/lessons/webgl-multiple-views.html">Multiple Views, Multiple Canvases</a></li>
<li><a href="/webgl/lessons/webgl-visualizing-the-camera.html">Visualizing the Camera</a></li>
<li><a href="/webgl/lessons/webgl-and-alpha.html">WebGL2 and Alpha</a></li>
<li><a href="/webgl/lessons/webgl-2d-vs-3d-library.html">2D vs 3D libraries</a></li>
<li><a href="/webgl/lessons/webgl-anti-patterns.html">Anti-Patterns</a></li>
<li><a href="/webgl/lessons/webgl-matrix-vs-math.html">WebGL2 Matrices vs Math Matrices</a></li>
<li><a href="/webgl/lessons/webgl-precision-issues.html">Precision Issues</a></li>
<li><a href="/webgl/lessons/webgl-tips.html#screenshot">Taking a screenshot</a></li>
<li><a href="/webgl/lessons/webgl-tips.html#preservedrawingbuffer">Prevent the Canvas Being Cleared</a></li>
<li><a href="/webgl/lessons/webgl-tips.html#tabindex">Get Keyboard Input From a Canvas</a></li>
<li><a href="/webgl/lessons/webgl-tips.html#html-background">Use WebGL2 as Background in HTML</a></li>
<li><a href="/webgl/lessons/webgl-cross-platform-issues.html">Cross Platform Issues</a></li>
<li><a href="/webgl/lessons/webgl-qna.html">Questions and Answers</a></li>
        </ul>
  <li>Reference</li>
        <ul>
          <li><a href="/webgl/lessons/webgl-attributes.html">Attributes</a></li>
<li><a href="/webgl/lessons/webgl-texture-units.html">Texture Units</a></li>
<li><a href="/webgl/lessons/webgl-framebuffers.html">Framebuffers</a></li>
<li><a href="/webgl/lessons/webgl-readpixels.html">readPixels</a></li>
<li><a href="/webgl/lessons/webgl-references.html">References</a></li>
        </ul></ul>
<ul>
  <li><a href="/docs/">Helper API Docs</a></li>
  <li><a href="https://twgljs.org">TWGL, A tiny WebGL helper library</a></li>
  <li><a href="https://github.com/gfxfundamentals/webgl2-fundamentals">github</a></li>
</ul>
        </div>
    </div>
    <div class="lesson-comments">
        
<div>Issue/Bug? <a href="https://github.com/gfxfundamentals/webgl2-fundamentals/issues">Create an issue on github</a>.</div>
<div class="lesson-comment-notes">
   Use <b>&lt;pre&gt;&lt;code&gt;</b>code goes here<b>&lt;/code&gt;&lt;/pre&gt;</b> for code blocks
</div>
  

        <div id="disqus_thread"></div>
        <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webgl2fundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL2 from WebGL1';
            var disqus_title = 'WebGL2 from WebGL1';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webgl2fundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script>
const settings = {
  contribTemplate: "Thank you <a href=\"${html_url}\"><img src=\"${avatar_url}\"> ${login}</a><br>for <a href=\"https://github.com/${owner}/${repo}/commits?author=${login}\">${contributions} contributions</a>",
  owner: "gfxfundamentals",
  repo: "webgl2-fundamentals",
};
</script>
<script src="/contributors.js"></script>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js" type="module"></script>
<script>
</script>


</html>



